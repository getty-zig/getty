<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>crypto/sha3.zig - source view</title>
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAPNJREFUeNpi/P//PwMlgOXHUjly9E0G4hwgZmQiQZMqEK8H4v9QzUEgQSaoADK+zhH9iAGL+C0gDoAaNg9mGLoLfgA1awK9hS9gzgJxA9RQBmQDrgMxJzRMGKE4HYj/Ial5A8QmQLwCJoBsgBYW2+TR1ChDaWt4LOBxKsi/VUh8XiD+gq4IVyzwQAMJBoKwacZlAB8Qf0bi96IZhtOAe1D6LpqaEiz6rmEzQAeIzwGxCJpieFqApo/vQKyJboAaEBsAsSEupwI1MwKjGBTVHOhegMX5UajYRqiBjMgYmj400cVh0XgTiKdC0zhJgJHS7AwQYABm9EAdCKrEfAAAAABJRU5ErkJggg=="/>
    <style>
      body{
        font-family: system-ui, -apple-system, Roboto, "Segoe UI", sans-serif;
        margin: 0;
        line-height: 1.5;
      }

      pre > code {
        display: block;
        overflow: auto;
        line-height: normal;
        margin: 0em;
      }
      .tok-kw {
          color: #333;
          font-weight: bold;
      }
      .tok-str {
          color: #d14;
      }
      .tok-builtin {
          color: #005C7A;
      }
      .tok-comment {
          color: #545454;
          font-style: italic;
      }
      .tok-fn {
          color: #900;
          font-weight: bold;
      }
      .tok-null {
          color: #005C5C;
      }
      .tok-number {
          color: #005C5C;
      }
      .tok-type {
          color: #458;
          font-weight: bold;
      }
      pre {
        counter-reset: line;
      }
      pre .line:before {
        counter-increment: line;
        content: counter(line);
        display: inline-block;
        padding-right: 1em;
        width: 2em;
        text-align: right;
        color: #999;
      }
      
      .line {
        width: 100%;
        display: inline-block;
      }
      .line:target {
        border-top: 1px solid #ccc;
        border-bottom: 1px solid #ccc;
        background: #fafafa;
      }

      @media (prefers-color-scheme: dark) {
        body{
            background:#222;
            color: #ccc;
        }
        pre > code {
            color: #ccc;
            background: #222;
            border: unset;
        }
        .line:target {
            border-top: 1px solid #444;
            border-bottom: 1px solid #444;
            background: #333;
        }
        .tok-kw {
            color: #eee;
        }
        .tok-str {
            color: #2e5;
        }
        .tok-builtin {
            color: #ff894c;
        }
        .tok-comment {
            color: #aa7;
        }
        .tok-fn {
            color: #B1A0F8;
        }
        .tok-null {
            color: #ff8080;
        }
        .tok-number {
            color: #ff8080;
        }
        .tok-type {
            color: #68f;
        }
      }
    </style>
</head>
<body>
<pre><code><span class="line" id="L1"><span class="tok-kw">const</span> std = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;std&quot;</span>);</span>
<span class="line" id="L2"><span class="tok-kw">const</span> assert = std.debug.assert;</span>
<span class="line" id="L3"><span class="tok-kw">const</span> math = std.math;</span>
<span class="line" id="L4"><span class="tok-kw">const</span> mem = std.mem;</span>
<span class="line" id="L5"></span>
<span class="line" id="L6"><span class="tok-kw">const</span> KeccakState = std.crypto.core.keccak.State;</span>
<span class="line" id="L7"></span>
<span class="line" id="L8"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Sha3_224 = Keccak(<span class="tok-number">1600</span>, <span class="tok-number">224</span>, <span class="tok-number">0x06</span>, <span class="tok-number">24</span>);</span>
<span class="line" id="L9"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Sha3_256 = Keccak(<span class="tok-number">1600</span>, <span class="tok-number">256</span>, <span class="tok-number">0x06</span>, <span class="tok-number">24</span>);</span>
<span class="line" id="L10"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Sha3_384 = Keccak(<span class="tok-number">1600</span>, <span class="tok-number">384</span>, <span class="tok-number">0x06</span>, <span class="tok-number">24</span>);</span>
<span class="line" id="L11"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Sha3_512 = Keccak(<span class="tok-number">1600</span>, <span class="tok-number">512</span>, <span class="tok-number">0x06</span>, <span class="tok-number">24</span>);</span>
<span class="line" id="L12"></span>
<span class="line" id="L13"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Keccak256 = Keccak(<span class="tok-number">1600</span>, <span class="tok-number">256</span>, <span class="tok-number">0x01</span>, <span class="tok-number">24</span>);</span>
<span class="line" id="L14"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Keccak512 = Keccak(<span class="tok-number">1600</span>, <span class="tok-number">512</span>, <span class="tok-number">0x01</span>, <span class="tok-number">24</span>);</span>
<span class="line" id="L15"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Keccak_256 = <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;Deprecated: use `Keccak256` instead&quot;</span>);</span>
<span class="line" id="L16"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Keccak_512 = <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;Deprecated: use `Keccak512` instead&quot;</span>);</span>
<span class="line" id="L17"></span>
<span class="line" id="L18"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Shake128 = Shake(<span class="tok-number">128</span>);</span>
<span class="line" id="L19"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Shake256 = Shake(<span class="tok-number">256</span>);</span>
<span class="line" id="L20"></span>
<span class="line" id="L21"><span class="tok-comment">/// TurboSHAKE128 is a XOF (a secure hash function with a variable output length), with a 128 bit security level.</span></span>
<span class="line" id="L22"><span class="tok-comment">/// It is based on the same permutation as SHA3 and SHAKE128, but which much higher performance.</span></span>
<span class="line" id="L23"><span class="tok-comment">/// The delimiter is 0x1f by default, but can be changed for context-separation.</span></span>
<span class="line" id="L24"><span class="tok-comment">/// For a protocol that uses both KangarooTwelve and TurboSHAKE128, it is recommended to avoid using 0x06, 0x07 or 0x0b for the delimiter.</span></span>
<span class="line" id="L25"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">TurboShake128</span>(<span class="tok-kw">comptime</span> delim: ?<span class="tok-type">u7</span>) <span class="tok-type">type</span> {</span>
<span class="line" id="L26">    <span class="tok-kw">return</span> TurboShake(<span class="tok-number">128</span>, delim);</span>
<span class="line" id="L27">}</span>
<span class="line" id="L28"></span>
<span class="line" id="L29"><span class="tok-comment">/// TurboSHAKE256 is a XOF (a secure hash function with a variable output length), with a 256 bit security level.</span></span>
<span class="line" id="L30"><span class="tok-comment">/// It is based on the same permutation as SHA3 and SHAKE256, but which much higher performance.</span></span>
<span class="line" id="L31"><span class="tok-comment">/// The delimiter is 0x1f by default, but can be changed for context-separation.</span></span>
<span class="line" id="L32"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">TurboShake256</span>(<span class="tok-kw">comptime</span> delim: ?<span class="tok-type">u7</span>) <span class="tok-type">type</span> {</span>
<span class="line" id="L33">    <span class="tok-kw">return</span> TurboShake(<span class="tok-number">256</span>, delim);</span>
<span class="line" id="L34">}</span>
<span class="line" id="L35"></span>
<span class="line" id="L36"><span class="tok-comment">/// A generic Keccak hash function.</span></span>
<span class="line" id="L37"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">Keccak</span>(<span class="tok-kw">comptime</span> f: <span class="tok-type">u11</span>, <span class="tok-kw">comptime</span> output_bits: <span class="tok-type">u11</span>, <span class="tok-kw">comptime</span> delim: <span class="tok-type">u8</span>, <span class="tok-kw">comptime</span> rounds: <span class="tok-type">u5</span>) <span class="tok-type">type</span> {</span>
<span class="line" id="L38">    <span class="tok-kw">comptime</span> assert(output_bits &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> output_bits * <span class="tok-number">2</span> &lt; f <span class="tok-kw">and</span> output_bits % <span class="tok-number">8</span> == <span class="tok-number">0</span>); <span class="tok-comment">// invalid output length</span>
</span>
<span class="line" id="L39"></span>
<span class="line" id="L40">    <span class="tok-kw">const</span> State = KeccakState(f, output_bits * <span class="tok-number">2</span>, delim, rounds);</span>
<span class="line" id="L41"></span>
<span class="line" id="L42">    <span class="tok-kw">return</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L43">        <span class="tok-kw">const</span> Self = <span class="tok-builtin">@This</span>();</span>
<span class="line" id="L44"></span>
<span class="line" id="L45">        st: State = .{},</span>
<span class="line" id="L46"></span>
<span class="line" id="L47">        <span class="tok-comment">/// The output length, in bytes.</span></span>
<span class="line" id="L48">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> digest_length = output_bits / <span class="tok-number">8</span>;</span>
<span class="line" id="L49">        <span class="tok-comment">/// The block length, or rate, in bytes.</span></span>
<span class="line" id="L50">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> block_length = State.rate;</span>
<span class="line" id="L51">        <span class="tok-comment">/// Keccak does not have any options.</span></span>
<span class="line" id="L52">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Options = <span class="tok-kw">struct</span> {};</span>
<span class="line" id="L53"></span>
<span class="line" id="L54">        <span class="tok-comment">/// Initialize a Keccak hash function.</span></span>
<span class="line" id="L55">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">init</span>(options: Options) Self {</span>
<span class="line" id="L56">            _ = options;</span>
<span class="line" id="L57">            <span class="tok-kw">return</span> Self{};</span>
<span class="line" id="L58">        }</span>
<span class="line" id="L59"></span>
<span class="line" id="L60">        <span class="tok-comment">/// Hash a slice of bytes.</span></span>
<span class="line" id="L61">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">hash</span>(bytes: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, out: *[digest_length]<span class="tok-type">u8</span>, options: Options) <span class="tok-type">void</span> {</span>
<span class="line" id="L62">            <span class="tok-kw">var</span> st = Self.init(options);</span>
<span class="line" id="L63">            st.update(bytes);</span>
<span class="line" id="L64">            st.final(out);</span>
<span class="line" id="L65">        }</span>
<span class="line" id="L66"></span>
<span class="line" id="L67">        <span class="tok-comment">/// Absorb a slice of bytes into the state.</span></span>
<span class="line" id="L68">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">update</span>(self: *Self, bytes: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L69">            self.st.absorb(bytes);</span>
<span class="line" id="L70">        }</span>
<span class="line" id="L71"></span>
<span class="line" id="L72">        <span class="tok-comment">/// Return the hash of the absorbed bytes.</span></span>
<span class="line" id="L73">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">final</span>(self: *Self, out: *[digest_length]<span class="tok-type">u8</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L74">            self.st.pad();</span>
<span class="line" id="L75">            self.st.squeeze(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L76">        }</span>
<span class="line" id="L77"></span>
<span class="line" id="L78">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Error = <span class="tok-kw">error</span>{};</span>
<span class="line" id="L79">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Writer = std.io.Writer(*Self, Error, write);</span>
<span class="line" id="L80"></span>
<span class="line" id="L81">        <span class="tok-kw">fn</span> <span class="tok-fn">write</span>(self: *Self, bytes: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) Error!<span class="tok-type">usize</span> {</span>
<span class="line" id="L82">            self.update(bytes);</span>
<span class="line" id="L83">            <span class="tok-kw">return</span> bytes.len;</span>
<span class="line" id="L84">        }</span>
<span class="line" id="L85"></span>
<span class="line" id="L86">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">writer</span>(self: *Self) Writer {</span>
<span class="line" id="L87">            <span class="tok-kw">return</span> .{ .context = self };</span>
<span class="line" id="L88">        }</span>
<span class="line" id="L89">    };</span>
<span class="line" id="L90">}</span>
<span class="line" id="L91"></span>
<span class="line" id="L92"><span class="tok-comment">/// The SHAKE extendable output hash function.</span></span>
<span class="line" id="L93"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">Shake</span>(<span class="tok-kw">comptime</span> security_level: <span class="tok-type">u11</span>) <span class="tok-type">type</span> {</span>
<span class="line" id="L94">    <span class="tok-kw">return</span> ShakeLike(security_level, <span class="tok-number">0x1f</span>, <span class="tok-number">24</span>);</span>
<span class="line" id="L95">}</span>
<span class="line" id="L96"></span>
<span class="line" id="L97"><span class="tok-comment">/// The TurboSHAKE extendable output hash function.</span></span>
<span class="line" id="L98"><span class="tok-comment">/// It is based on the same permutation as SHA3 and SHAKE, but which much higher performance.</span></span>
<span class="line" id="L99"><span class="tok-comment">/// The delimiter is 0x1f by default, but can be changed for context-separation.</span></span>
<span class="line" id="L100"><span class="tok-comment">/// https://eprint.iacr.org/2023/342</span></span>
<span class="line" id="L101"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">TurboShake</span>(<span class="tok-kw">comptime</span> security_level: <span class="tok-type">u11</span>, <span class="tok-kw">comptime</span> delim: ?<span class="tok-type">u7</span>) <span class="tok-type">type</span> {</span>
<span class="line" id="L102">    <span class="tok-kw">comptime</span> assert(security_level &lt;= <span class="tok-number">256</span>);</span>
<span class="line" id="L103">    <span class="tok-kw">const</span> d = delim <span class="tok-kw">orelse</span> <span class="tok-number">0x1f</span>;</span>
<span class="line" id="L104">    <span class="tok-kw">comptime</span> assert(d &gt;= <span class="tok-number">0x01</span>); <span class="tok-comment">// delimiter must be &gt;= 1</span>
</span>
<span class="line" id="L105">    <span class="tok-kw">return</span> ShakeLike(security_level, d, <span class="tok-number">12</span>);</span>
<span class="line" id="L106">}</span>
<span class="line" id="L107"></span>
<span class="line" id="L108"><span class="tok-kw">fn</span> <span class="tok-fn">ShakeLike</span>(<span class="tok-kw">comptime</span> security_level: <span class="tok-type">u11</span>, <span class="tok-kw">comptime</span> delim: <span class="tok-type">u8</span>, <span class="tok-kw">comptime</span> rounds: <span class="tok-type">u5</span>) <span class="tok-type">type</span> {</span>
<span class="line" id="L109">    <span class="tok-kw">const</span> f = <span class="tok-number">1600</span>;</span>
<span class="line" id="L110">    <span class="tok-kw">const</span> State = KeccakState(f, security_level * <span class="tok-number">2</span>, delim, rounds);</span>
<span class="line" id="L111"></span>
<span class="line" id="L112">    <span class="tok-kw">return</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L113">        <span class="tok-kw">const</span> Self = <span class="tok-builtin">@This</span>();</span>
<span class="line" id="L114"></span>
<span class="line" id="L115">        st: State = .{},</span>
<span class="line" id="L116">        buf: [State.rate]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>,</span>
<span class="line" id="L117">        offset: <span class="tok-type">usize</span> = <span class="tok-number">0</span>,</span>
<span class="line" id="L118">        padded: <span class="tok-type">bool</span> = <span class="tok-null">false</span>,</span>
<span class="line" id="L119"></span>
<span class="line" id="L120">        <span class="tok-comment">/// The recommended output length, in bytes.</span></span>
<span class="line" id="L121">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> digest_length = security_level / <span class="tok-number">2</span>;</span>
<span class="line" id="L122">        <span class="tok-comment">/// The block length, or rate, in bytes.</span></span>
<span class="line" id="L123">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> block_length = State.rate;</span>
<span class="line" id="L124">        <span class="tok-comment">/// Keccak does not have any options.</span></span>
<span class="line" id="L125">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Options = <span class="tok-kw">struct</span> {};</span>
<span class="line" id="L126"></span>
<span class="line" id="L127">        <span class="tok-comment">/// Initialize a SHAKE extensible hash function.</span></span>
<span class="line" id="L128">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">init</span>(options: Options) Self {</span>
<span class="line" id="L129">            _ = options;</span>
<span class="line" id="L130">            <span class="tok-kw">return</span> Self{};</span>
<span class="line" id="L131">        }</span>
<span class="line" id="L132"></span>
<span class="line" id="L133">        <span class="tok-comment">/// Hash a slice of bytes.</span></span>
<span class="line" id="L134">        <span class="tok-comment">/// `out` can be any length.</span></span>
<span class="line" id="L135">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">hash</span>(bytes: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, out: []<span class="tok-type">u8</span>, options: Options) <span class="tok-type">void</span> {</span>
<span class="line" id="L136">            <span class="tok-kw">var</span> st = Self.init(options);</span>
<span class="line" id="L137">            st.update(bytes);</span>
<span class="line" id="L138">            st.squeeze(out);</span>
<span class="line" id="L139">        }</span>
<span class="line" id="L140"></span>
<span class="line" id="L141">        <span class="tok-comment">/// Absorb a slice of bytes into the state.</span></span>
<span class="line" id="L142">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">update</span>(self: *Self, bytes: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L143">            self.st.absorb(bytes);</span>
<span class="line" id="L144">        }</span>
<span class="line" id="L145"></span>
<span class="line" id="L146">        <span class="tok-comment">/// Squeeze a slice of bytes from the state.</span></span>
<span class="line" id="L147">        <span class="tok-comment">/// `out` can be any length, and the function can be called multiple times.</span></span>
<span class="line" id="L148">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">squeeze</span>(self: *Self, out_: []<span class="tok-type">u8</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L149">            <span class="tok-kw">if</span> (!self.padded) {</span>
<span class="line" id="L150">                self.st.pad();</span>
<span class="line" id="L151">                self.padded = <span class="tok-null">true</span>;</span>
<span class="line" id="L152">            }</span>
<span class="line" id="L153">            <span class="tok-kw">var</span> out = out_;</span>
<span class="line" id="L154">            <span class="tok-kw">if</span> (self.offset &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L155">                <span class="tok-kw">const</span> left = self.buf.len - self.offset;</span>
<span class="line" id="L156">                <span class="tok-kw">if</span> (left &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L157">                    <span class="tok-kw">const</span> n = <span class="tok-builtin">@min</span>(left, out.len);</span>
<span class="line" id="L158">                    <span class="tok-builtin">@memcpy</span>(out[<span class="tok-number">0</span>..n], self.buf[self.offset..][<span class="tok-number">0</span>..n]);</span>
<span class="line" id="L159">                    out = out[n..];</span>
<span class="line" id="L160">                    self.offset += n;</span>
<span class="line" id="L161">                    <span class="tok-kw">if</span> (out.len == <span class="tok-number">0</span>) {</span>
<span class="line" id="L162">                        <span class="tok-kw">return</span>;</span>
<span class="line" id="L163">                    }</span>
<span class="line" id="L164">                }</span>
<span class="line" id="L165">            }</span>
<span class="line" id="L166">            <span class="tok-kw">const</span> full_blocks = out[<span class="tok-number">0</span> .. out.len - out.len % State.rate];</span>
<span class="line" id="L167">            <span class="tok-kw">if</span> (full_blocks.len &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L168">                self.st.squeeze(full_blocks);</span>
<span class="line" id="L169">                out = out[full_blocks.len..];</span>
<span class="line" id="L170">            }</span>
<span class="line" id="L171">            <span class="tok-kw">if</span> (out.len &gt; <span class="tok-number">0</span>) {</span>
<span class="line" id="L172">                self.st.squeeze(self.buf[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L173">                <span class="tok-builtin">@memcpy</span>(out[<span class="tok-number">0</span>..], self.buf[<span class="tok-number">0</span>..out.len]);</span>
<span class="line" id="L174">                self.offset = out.len;</span>
<span class="line" id="L175">            }</span>
<span class="line" id="L176">        }</span>
<span class="line" id="L177"></span>
<span class="line" id="L178">        <span class="tok-comment">/// Return the hash of the absorbed bytes.</span></span>
<span class="line" id="L179">        <span class="tok-comment">/// `out` can be of any length, but the function must not be called multiple times (use `squeeze` for that purpose instead).</span></span>
<span class="line" id="L180">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">final</span>(self: *Self, out: []<span class="tok-type">u8</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L181">            self.squeeze(out);</span>
<span class="line" id="L182">            self.st.st.clear(<span class="tok-number">0</span>, State.rate);</span>
<span class="line" id="L183">        }</span>
<span class="line" id="L184"></span>
<span class="line" id="L185">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Error = <span class="tok-kw">error</span>{};</span>
<span class="line" id="L186">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Writer = std.io.Writer(*Self, Error, write);</span>
<span class="line" id="L187"></span>
<span class="line" id="L188">        <span class="tok-kw">fn</span> <span class="tok-fn">write</span>(self: *Self, bytes: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) Error!<span class="tok-type">usize</span> {</span>
<span class="line" id="L189">            self.update(bytes);</span>
<span class="line" id="L190">            <span class="tok-kw">return</span> bytes.len;</span>
<span class="line" id="L191">        }</span>
<span class="line" id="L192"></span>
<span class="line" id="L193">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">writer</span>(self: *Self) Writer {</span>
<span class="line" id="L194">            <span class="tok-kw">return</span> .{ .context = self };</span>
<span class="line" id="L195">        }</span>
<span class="line" id="L196">    };</span>
<span class="line" id="L197">}</span>
<span class="line" id="L198"></span>
<span class="line" id="L199"><span class="tok-kw">const</span> htest = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;test.zig&quot;</span>);</span>
<span class="line" id="L200"></span>
<span class="line" id="L201"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-224 single&quot;</span> {</span>
<span class="line" id="L202">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_224, <span class="tok-str">&quot;6b4e03423667dbb73b6e15454f0eb1abd4597f9a1b078e3f5b5a6bc7&quot;</span>, <span class="tok-str">&quot;&quot;</span>);</span>
<span class="line" id="L203">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_224, <span class="tok-str">&quot;e642824c3f8cf24ad09234ee7d3c766fc9a3a5168d0c94ad73b46fdf&quot;</span>, <span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L204">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_224, <span class="tok-str">&quot;543e6868e1666c1a643630df77367ae5a62a85070a51c14cbf665cbc&quot;</span>, <span class="tok-str">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span>);</span>
<span class="line" id="L205">}</span>
<span class="line" id="L206"></span>
<span class="line" id="L207"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-224 streaming&quot;</span> {</span>
<span class="line" id="L208">    <span class="tok-kw">var</span> h = Sha3_224.init(.{});</span>
<span class="line" id="L209">    <span class="tok-kw">var</span> out: [<span class="tok-number">28</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L210"></span>
<span class="line" id="L211">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L212">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;6b4e03423667dbb73b6e15454f0eb1abd4597f9a1b078e3f5b5a6bc7&quot;</span>, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L213"></span>
<span class="line" id="L214">    h = Sha3_224.init(.{});</span>
<span class="line" id="L215">    h.update(<span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L216">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L217">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;e642824c3f8cf24ad09234ee7d3c766fc9a3a5168d0c94ad73b46fdf&quot;</span>, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L218"></span>
<span class="line" id="L219">    h = Sha3_224.init(.{});</span>
<span class="line" id="L220">    h.update(<span class="tok-str">&quot;a&quot;</span>);</span>
<span class="line" id="L221">    h.update(<span class="tok-str">&quot;b&quot;</span>);</span>
<span class="line" id="L222">    h.update(<span class="tok-str">&quot;c&quot;</span>);</span>
<span class="line" id="L223">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L224">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;e642824c3f8cf24ad09234ee7d3c766fc9a3a5168d0c94ad73b46fdf&quot;</span>, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L225">}</span>
<span class="line" id="L226"></span>
<span class="line" id="L227"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-256 single&quot;</span> {</span>
<span class="line" id="L228">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_256, <span class="tok-str">&quot;a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a&quot;</span>, <span class="tok-str">&quot;&quot;</span>);</span>
<span class="line" id="L229">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_256, <span class="tok-str">&quot;3a985da74fe225b2045c172d6bd390bd855f086e3e9d525b46bfe24511431532&quot;</span>, <span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L230">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_256, <span class="tok-str">&quot;916f6061fe879741ca6469b43971dfdb28b1a32dc36cb3254e812be27aad1d18&quot;</span>, <span class="tok-str">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span>);</span>
<span class="line" id="L231">}</span>
<span class="line" id="L232"></span>
<span class="line" id="L233"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-256 streaming&quot;</span> {</span>
<span class="line" id="L234">    <span class="tok-kw">var</span> h = Sha3_256.init(.{});</span>
<span class="line" id="L235">    <span class="tok-kw">var</span> out: [<span class="tok-number">32</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L236"></span>
<span class="line" id="L237">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L238">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a&quot;</span>, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L239"></span>
<span class="line" id="L240">    h = Sha3_256.init(.{});</span>
<span class="line" id="L241">    h.update(<span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L242">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L243">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;3a985da74fe225b2045c172d6bd390bd855f086e3e9d525b46bfe24511431532&quot;</span>, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L244"></span>
<span class="line" id="L245">    h = Sha3_256.init(.{});</span>
<span class="line" id="L246">    h.update(<span class="tok-str">&quot;a&quot;</span>);</span>
<span class="line" id="L247">    h.update(<span class="tok-str">&quot;b&quot;</span>);</span>
<span class="line" id="L248">    h.update(<span class="tok-str">&quot;c&quot;</span>);</span>
<span class="line" id="L249">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L250">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;3a985da74fe225b2045c172d6bd390bd855f086e3e9d525b46bfe24511431532&quot;</span>, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L251">}</span>
<span class="line" id="L252"></span>
<span class="line" id="L253"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-256 aligned final&quot;</span> {</span>
<span class="line" id="L254">    <span class="tok-kw">var</span> block = [_]<span class="tok-type">u8</span>{<span class="tok-number">0</span>} ** Sha3_256.block_length;</span>
<span class="line" id="L255">    <span class="tok-kw">var</span> out: [Sha3_256.digest_length]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L256"></span>
<span class="line" id="L257">    <span class="tok-kw">var</span> h = Sha3_256.init(.{});</span>
<span class="line" id="L258">    h.update(&amp;block);</span>
<span class="line" id="L259">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L260">}</span>
<span class="line" id="L261"></span>
<span class="line" id="L262"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-384 single&quot;</span> {</span>
<span class="line" id="L263">    <span class="tok-kw">const</span> h1 = <span class="tok-str">&quot;0c63a75b845e4f7d01107d852e4c2485c51a50aaaa94fc61995e71bbee983a2ac3713831264adb47fb6bd1e058d5f004&quot;</span>;</span>
<span class="line" id="L264">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_384, h1, <span class="tok-str">&quot;&quot;</span>);</span>
<span class="line" id="L265">    <span class="tok-kw">const</span> h2 = <span class="tok-str">&quot;ec01498288516fc926459f58e2c6ad8df9b473cb0fc08c2596da7cf0e49be4b298d88cea927ac7f539f1edf228376d25&quot;</span>;</span>
<span class="line" id="L266">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_384, h2, <span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L267">    <span class="tok-kw">const</span> h3 = <span class="tok-str">&quot;79407d3b5916b59c3e30b09822974791c313fb9ecc849e406f23592d04f625dc8c709b98b43b3852b337216179aa7fc7&quot;</span>;</span>
<span class="line" id="L268">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_384, h3, <span class="tok-str">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span>);</span>
<span class="line" id="L269">}</span>
<span class="line" id="L270"></span>
<span class="line" id="L271"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-384 streaming&quot;</span> {</span>
<span class="line" id="L272">    <span class="tok-kw">var</span> h = Sha3_384.init(.{});</span>
<span class="line" id="L273">    <span class="tok-kw">var</span> out: [<span class="tok-number">48</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L274"></span>
<span class="line" id="L275">    <span class="tok-kw">const</span> h1 = <span class="tok-str">&quot;0c63a75b845e4f7d01107d852e4c2485c51a50aaaa94fc61995e71bbee983a2ac3713831264adb47fb6bd1e058d5f004&quot;</span>;</span>
<span class="line" id="L276">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L277">    <span class="tok-kw">try</span> htest.assertEqual(h1, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L278"></span>
<span class="line" id="L279">    <span class="tok-kw">const</span> h2 = <span class="tok-str">&quot;ec01498288516fc926459f58e2c6ad8df9b473cb0fc08c2596da7cf0e49be4b298d88cea927ac7f539f1edf228376d25&quot;</span>;</span>
<span class="line" id="L280">    h = Sha3_384.init(.{});</span>
<span class="line" id="L281">    h.update(<span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L282">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L283">    <span class="tok-kw">try</span> htest.assertEqual(h2, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L284"></span>
<span class="line" id="L285">    h = Sha3_384.init(.{});</span>
<span class="line" id="L286">    h.update(<span class="tok-str">&quot;a&quot;</span>);</span>
<span class="line" id="L287">    h.update(<span class="tok-str">&quot;b&quot;</span>);</span>
<span class="line" id="L288">    h.update(<span class="tok-str">&quot;c&quot;</span>);</span>
<span class="line" id="L289">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L290">    <span class="tok-kw">try</span> htest.assertEqual(h2, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L291">}</span>
<span class="line" id="L292"></span>
<span class="line" id="L293"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-512 single&quot;</span> {</span>
<span class="line" id="L294">    <span class="tok-kw">const</span> h1 = <span class="tok-str">&quot;a69f73cca23a9ac5c8b567dc185a756e97c982164fe25859e0d1dcc1475c80a615b2123af1f5f94c11e3e9402c3ac558f500199d95b6d3e301758586281dcd26&quot;</span>;</span>
<span class="line" id="L295">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_512, h1, <span class="tok-str">&quot;&quot;</span>);</span>
<span class="line" id="L296">    <span class="tok-kw">const</span> h2 = <span class="tok-str">&quot;b751850b1a57168a5693cd924b6b096e08f621827444f70d884f5d0240d2712e10e116e9192af3c91a7ec57647e3934057340b4cf408d5a56592f8274eec53f0&quot;</span>;</span>
<span class="line" id="L297">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_512, h2, <span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L298">    <span class="tok-kw">const</span> h3 = <span class="tok-str">&quot;afebb2ef542e6579c50cad06d2e578f9f8dd6881d7dc824d26360feebf18a4fa73e3261122948efcfd492e74e82e2189ed0fb440d187f382270cb455f21dd185&quot;</span>;</span>
<span class="line" id="L299">    <span class="tok-kw">try</span> htest.assertEqualHash(Sha3_512, h3, <span class="tok-str">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span>);</span>
<span class="line" id="L300">}</span>
<span class="line" id="L301"></span>
<span class="line" id="L302"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-512 streaming&quot;</span> {</span>
<span class="line" id="L303">    <span class="tok-kw">var</span> h = Sha3_512.init(.{});</span>
<span class="line" id="L304">    <span class="tok-kw">var</span> out: [<span class="tok-number">64</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L305"></span>
<span class="line" id="L306">    <span class="tok-kw">const</span> h1 = <span class="tok-str">&quot;a69f73cca23a9ac5c8b567dc185a756e97c982164fe25859e0d1dcc1475c80a615b2123af1f5f94c11e3e9402c3ac558f500199d95b6d3e301758586281dcd26&quot;</span>;</span>
<span class="line" id="L307">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L308">    <span class="tok-kw">try</span> htest.assertEqual(h1, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L309"></span>
<span class="line" id="L310">    <span class="tok-kw">const</span> h2 = <span class="tok-str">&quot;b751850b1a57168a5693cd924b6b096e08f621827444f70d884f5d0240d2712e10e116e9192af3c91a7ec57647e3934057340b4cf408d5a56592f8274eec53f0&quot;</span>;</span>
<span class="line" id="L311">    h = Sha3_512.init(.{});</span>
<span class="line" id="L312">    h.update(<span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L313">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L314">    <span class="tok-kw">try</span> htest.assertEqual(h2, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L315"></span>
<span class="line" id="L316">    h = Sha3_512.init(.{});</span>
<span class="line" id="L317">    h.update(<span class="tok-str">&quot;a&quot;</span>);</span>
<span class="line" id="L318">    h.update(<span class="tok-str">&quot;b&quot;</span>);</span>
<span class="line" id="L319">    h.update(<span class="tok-str">&quot;c&quot;</span>);</span>
<span class="line" id="L320">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L321">    <span class="tok-kw">try</span> htest.assertEqual(h2, out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L322">}</span>
<span class="line" id="L323"></span>
<span class="line" id="L324"><span class="tok-kw">test</span> <span class="tok-str">&quot;sha3-512 aligned final&quot;</span> {</span>
<span class="line" id="L325">    <span class="tok-kw">var</span> block = [_]<span class="tok-type">u8</span>{<span class="tok-number">0</span>} ** Sha3_512.block_length;</span>
<span class="line" id="L326">    <span class="tok-kw">var</span> out: [Sha3_512.digest_length]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L327"></span>
<span class="line" id="L328">    <span class="tok-kw">var</span> h = Sha3_512.init(.{});</span>
<span class="line" id="L329">    h.update(&amp;block);</span>
<span class="line" id="L330">    h.final(out[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L331">}</span>
<span class="line" id="L332"></span>
<span class="line" id="L333"><span class="tok-kw">test</span> <span class="tok-str">&quot;keccak-256 single&quot;</span> {</span>
<span class="line" id="L334">    <span class="tok-kw">try</span> htest.assertEqualHash(Keccak256, <span class="tok-str">&quot;c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470&quot;</span>, <span class="tok-str">&quot;&quot;</span>);</span>
<span class="line" id="L335">    <span class="tok-kw">try</span> htest.assertEqualHash(Keccak256, <span class="tok-str">&quot;4e03657aea45a94fc7d47ba826c8d667c0d1e6e33a64a036ec44f58fa12d6c45&quot;</span>, <span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L336">    <span class="tok-kw">try</span> htest.assertEqualHash(Keccak256, <span class="tok-str">&quot;f519747ed599024f3882238e5ab43960132572b7345fbeb9a90769dafd21ad67&quot;</span>, <span class="tok-str">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span>);</span>
<span class="line" id="L337">}</span>
<span class="line" id="L338"></span>
<span class="line" id="L339"><span class="tok-kw">test</span> <span class="tok-str">&quot;keccak-512 single&quot;</span> {</span>
<span class="line" id="L340">    <span class="tok-kw">try</span> htest.assertEqualHash(Keccak512, <span class="tok-str">&quot;0eab42de4c3ceb9235fc91acffe746b29c29a8c366b7c60e4e67c466f36a4304c00fa9caf9d87976ba469bcbe06713b435f091ef2769fb160cdab33d3670680e&quot;</span>, <span class="tok-str">&quot;&quot;</span>);</span>
<span class="line" id="L341">    <span class="tok-kw">try</span> htest.assertEqualHash(Keccak512, <span class="tok-str">&quot;18587dc2ea106b9a1563e32b3312421ca164c7f1f07bc922a9c83d77cea3a1e5d0c69910739025372dc14ac9642629379540c17e2a65b19d77aa511a9d00bb96&quot;</span>, <span class="tok-str">&quot;abc&quot;</span>);</span>
<span class="line" id="L342">    <span class="tok-kw">try</span> htest.assertEqualHash(Keccak512, <span class="tok-str">&quot;ac2fb35251825d3aa48468a9948c0a91b8256f6d97d8fa4160faff2dd9dfcc24f3f1db7a983dad13d53439ccac0b37e24037e7b95f80f59f37a2f683c4ba4682&quot;</span>, <span class="tok-str">&quot;abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu&quot;</span>);</span>
<span class="line" id="L343">}</span>
<span class="line" id="L344"></span>
<span class="line" id="L345"><span class="tok-kw">test</span> <span class="tok-str">&quot;SHAKE-128 single&quot;</span> {</span>
<span class="line" id="L346">    <span class="tok-kw">var</span> out: [<span class="tok-number">10</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L347">    Shake128.hash(<span class="tok-str">&quot;hello123&quot;</span>, &amp;out, .{});</span>
<span class="line" id="L348">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;1b85861510bc4d8e467d&quot;</span>, &amp;out);</span>
<span class="line" id="L349">}</span>
<span class="line" id="L350"></span>
<span class="line" id="L351"><span class="tok-kw">test</span> <span class="tok-str">&quot;SHAKE-128 multisqueeze&quot;</span> {</span>
<span class="line" id="L352">    <span class="tok-kw">var</span> out: [<span class="tok-number">10</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L353">    <span class="tok-kw">var</span> h = Shake128.init(.{});</span>
<span class="line" id="L354">    h.update(<span class="tok-str">&quot;hello123&quot;</span>);</span>
<span class="line" id="L355">    h.squeeze(out[<span class="tok-number">0</span>..<span class="tok-number">4</span>]);</span>
<span class="line" id="L356">    h.squeeze(out[<span class="tok-number">4</span>..]);</span>
<span class="line" id="L357">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;1b85861510bc4d8e467d&quot;</span>, &amp;out);</span>
<span class="line" id="L358">}</span>
<span class="line" id="L359"></span>
<span class="line" id="L360"><span class="tok-kw">test</span> <span class="tok-str">&quot;SHAKE-128 multisqueeze with multiple blocks&quot;</span> {</span>
<span class="line" id="L361">    <span class="tok-kw">var</span> out: [<span class="tok-number">100</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L362">    <span class="tok-kw">var</span> out2: [<span class="tok-number">100</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L363"></span>
<span class="line" id="L364">    <span class="tok-kw">var</span> h = Shake128.init(.{});</span>
<span class="line" id="L365">    h.update(<span class="tok-str">&quot;hello123&quot;</span>);</span>
<span class="line" id="L366">    h.squeeze(out[<span class="tok-number">0</span>..<span class="tok-number">50</span>]);</span>
<span class="line" id="L367">    h.squeeze(out[<span class="tok-number">50</span>..]);</span>
<span class="line" id="L368"></span>
<span class="line" id="L369">    <span class="tok-kw">var</span> h2 = Shake128.init(.{});</span>
<span class="line" id="L370">    h2.update(<span class="tok-str">&quot;hello123&quot;</span>);</span>
<span class="line" id="L371">    h2.squeeze(&amp;out2);</span>
<span class="line" id="L372">    <span class="tok-kw">try</span> std.testing.expectEqualSlices(<span class="tok-type">u8</span>, &amp;out, &amp;out2);</span>
<span class="line" id="L373">}</span>
<span class="line" id="L374"></span>
<span class="line" id="L375"><span class="tok-kw">test</span> <span class="tok-str">&quot;SHAKE-256 single&quot;</span> {</span>
<span class="line" id="L376">    <span class="tok-kw">var</span> out: [<span class="tok-number">10</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L377">    Shake256.hash(<span class="tok-str">&quot;hello123&quot;</span>, &amp;out, .{});</span>
<span class="line" id="L378">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;ade612ba265f92de4a37&quot;</span>, &amp;out);</span>
<span class="line" id="L379">}</span>
<span class="line" id="L380"></span>
<span class="line" id="L381"><span class="tok-kw">test</span> <span class="tok-str">&quot;TurboSHAKE-128&quot;</span> {</span>
<span class="line" id="L382">    <span class="tok-kw">var</span> out: [<span class="tok-number">32</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L383">    TurboShake(<span class="tok-number">128</span>, <span class="tok-number">0x06</span>).hash(<span class="tok-str">&quot;\xff&quot;</span>, &amp;out, .{});</span>
<span class="line" id="L384">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;8ec9c66465ed0d4a6c35d13506718d687a25cb05c74cca1e42501abd83874a67&quot;</span>, &amp;out);</span>
<span class="line" id="L385">}</span>
<span class="line" id="L386"></span>
<span class="line" id="L387"><span class="tok-kw">test</span> <span class="tok-str">&quot;SHA-3 with streaming&quot;</span> {</span>
<span class="line" id="L388">    <span class="tok-kw">var</span> msg: [<span class="tok-number">613</span>]<span class="tok-type">u8</span> = [<span class="tok-number">613</span>]<span class="tok-type">u8</span>{ <span class="tok-number">0x97</span>, <span class="tok-number">0xd1</span>, <span class="tok-number">0x2d</span>, <span class="tok-number">0x1a</span>, <span class="tok-number">0x16</span>, <span class="tok-number">0x2d</span>, <span class="tok-number">0x36</span>, <span class="tok-number">0x4d</span>, <span class="tok-number">0x20</span>, <span class="tok-number">0x62</span>, <span class="tok-number">0x19</span>, <span class="tok-number">0x0b</span>, <span class="tok-number">0x14</span>, <span class="tok-number">0x93</span>, <span class="tok-number">0xbb</span>, <span class="tok-number">0xf8</span>, <span class="tok-number">0x5b</span>, <span class="tok-number">0xea</span>, <span class="tok-number">0x04</span>, <span class="tok-number">0xc2</span>, <span class="tok-number">0x61</span>, <span class="tok-number">0x8e</span>, <span class="tok-number">0xd6</span>, <span class="tok-number">0x08</span>, <span class="tok-number">0x81</span>, <span class="tok-number">0xa1</span>, <span class="tok-number">0x1d</span>, <span class="tok-number">0x73</span>, <span class="tok-number">0x27</span>, <span class="tok-number">0x48</span>, <span class="tok-number">0xbf</span>, <span class="tok-number">0xa4</span>, <span class="tok-number">0xba</span>, <span class="tok-number">0xb1</span>, <span class="tok-number">0x9a</span>, <span class="tok-number">0x48</span>, <span class="tok-number">0x9c</span>, <span class="tok-number">0xf9</span>, <span class="tok-number">0x9b</span>, <span class="tok-number">0xff</span>, <span class="tok-number">0x34</span>, <span class="tok-number">0x48</span>, <span class="tok-number">0xa9</span>, <span class="tok-number">0x75</span>, <span class="tok-number">0xea</span>, <span class="tok-number">0xc8</span>, <span class="tok-number">0xa3</span>, <span class="tok-number">0x48</span>, <span class="tok-number">0x24</span>, <span class="tok-number">0x9d</span>, <span class="tok-number">0x75</span>, <span class="tok-number">0x27</span>, <span class="tok-number">0x48</span>, <span class="tok-number">0xec</span>, <span class="tok-number">0x03</span>, <span class="tok-number">0xb0</span>, <span class="tok-number">0xbb</span>, <span class="tok-number">0xdf</span>, <span class="tok-number">0x33</span>, <span class="tok-number">0x90</span>, <span class="tok-number">0xe3</span>, <span class="tok-number">0x93</span>, <span class="tok-number">0xed</span>, <span class="tok-number">0x68</span>, <span class="tok-number">0x24</span>, <span class="tok-number">0x39</span>, <span class="tok-number">0x12</span>, <span class="tok-number">0xdf</span>, <span class="tok-number">0xea</span>, <span class="tok-number">0xee</span>, <span class="tok-number">0x8c</span>, <span class="tok-number">0x9f</span>, <span class="tok-number">0x96</span>, <span class="tok-number">0xde</span>, <span class="tok-number">0x42</span>, <span class="tok-number">0x46</span>, <span class="tok-number">0x8c</span>, <span class="tok-number">0x2b</span>, <span class="tok-number">0x17</span>, <span class="tok-number">0x83</span>, <span class="tok-number">0x36</span>, <span class="tok-number">0xfb</span>, <span class="tok-number">0xf4</span>, <span class="tok-number">0xf7</span>, <span class="tok-number">0xff</span>, <span class="tok-number">0x79</span>, <span class="tok-number">0xb9</span>, <span class="tok-number">0x45</span>, <span class="tok-number">0x41</span>, <span class="tok-number">0xc9</span>, <span class="tok-number">0x56</span>, <span class="tok-number">0x1a</span>, <span class="tok-number">0x6b</span>, <span class="tok-number">0x0c</span>, <span class="tok-number">0xa4</span>, <span class="tok-number">0x1a</span>, <span class="tok-number">0xdd</span>, <span class="tok-number">0x6b</span>, <span class="tok-number">0x95</span>, <span class="tok-number">0xe8</span>, <span class="tok-number">0x03</span>, <span class="tok-number">0x0f</span>, <span class="tok-number">0x09</span>, <span class="tok-number">0x29</span>, <span class="tok-number">0x40</span>, <span class="tok-number">0x1b</span>, <span class="tok-number">0xea</span>, <span class="tok-number">0x87</span>, <span class="tok-number">0xfa</span>, <span class="tok-number">0xb9</span>, <span class="tok-number">0x18</span>, <span class="tok-number">0xa9</span>, <span class="tok-number">0x95</span>, <span class="tok-number">0x07</span>, <span class="tok-number">0x7c</span>, <span class="tok-number">0x2f</span>, <span class="tok-number">0x7c</span>, <span class="tok-number">0x33</span>, <span class="tok-number">0xfb</span>, <span class="tok-number">0xc5</span>, <span class="tok-number">0x11</span>, <span class="tok-number">0x5e</span>, <span class="tok-number">0x81</span>, <span class="tok-number">0x0e</span>, <span class="tok-number">0xbc</span>, <span class="tok-number">0xae</span>, <span class="tok-number">0xec</span>, <span class="tok-number">0xb3</span>, <span class="tok-number">0xe1</span>, <span class="tok-number">0x4a</span>, <span class="tok-number">0x26</span>, <span class="tok-number">0x56</span>, <span class="tok-number">0xe8</span>, <span class="tok-number">0x5b</span>, <span class="tok-number">0x11</span>, <span class="tok-number">0x9d</span>, <span class="tok-number">0x37</span>, <span class="tok-number">0x06</span>, <span class="tok-number">0x9b</span>, <span class="tok-number">0x34</span>, <span class="tok-number">0x31</span>, <span class="tok-number">0x6e</span>, <span class="tok-number">0xa3</span>, <span class="tok-number">0xba</span>, <span class="tok-number">0x41</span>, <span class="tok-number">0xbc</span>, <span class="tok-number">0x11</span>, <span class="tok-number">0xd8</span>, <span class="tok-number">0xc5</span>, <span class="tok-number">0x15</span>, <span class="tok-number">0xc9</span>, <span class="tok-number">0x30</span>, <span class="tok-number">0x2c</span>, <span class="tok-number">0x9b</span>, <span class="tok-number">0xb6</span>, <span class="tok-number">0x71</span>, <span class="tok-number">0xd8</span>, <span class="tok-number">0x7c</span>, <span class="tok-number">0xbc</span>, <span class="tok-number">0x38</span>, <span class="tok-number">0x2f</span>, <span class="tok-number">0xd5</span>, <span class="tok-number">0xbd</span>, <span class="tok-number">0x30</span>, <span class="tok-number">0x96</span>, <span class="tok-number">0xd4</span>, <span class="tok-number">0xa3</span>, <span class="tok-number">0x00</span>, <span class="tok-number">0x77</span>, <span class="tok-number">0x9d</span>, <span class="tok-number">0x55</span>, <span class="tok-number">0x4a</span>, <span class="tok-number">0x33</span>, <span class="tok-number">0x53</span>, <span class="tok-number">0xb6</span>, <span class="tok-number">0xb3</span>, <span class="tok-number">0x35</span>, <span class="tok-number">0x1b</span>, <span class="tok-number">0xae</span>, <span class="tok-number">0xe5</span>, <span class="tok-number">0xdc</span>, <span class="tok-number">0x22</span>, <span class="tok-number">0x23</span>, <span class="tok-number">0x85</span>, <span class="tok-number">0x95</span>, <span class="tok-number">0x88</span>, <span class="tok-number">0xf9</span>, <span class="tok-number">0x3b</span>, <span class="tok-number">0xbf</span>, <span class="tok-number">0x74</span>, <span class="tok-number">0x13</span>, <span class="tok-number">0xaa</span>, <span class="tok-number">0xcb</span>, <span class="tok-number">0x0a</span>, <span class="tok-number">0x60</span>, <span class="tok-number">0x79</span>, <span class="tok-number">0x13</span>, <span class="tok-number">0x79</span>, <span class="tok-number">0xc0</span>, <span class="tok-number">0x4a</span>, <span class="tok-number">0x02</span>, <span class="tok-number">0xdb</span>, <span class="tok-number">0x1c</span>, <span class="tok-number">0xc9</span>, <span class="tok-number">0xff</span>, <span class="tok-number">0x60</span>, <span class="tok-number">0x57</span>, <span class="tok-number">0x9a</span>, <span class="tok-number">0x70</span>, <span class="tok-number">0x28</span>, <span class="tok-number">0x58</span>, <span class="tok-number">0x60</span>, <span class="tok-number">0xbc</span>, <span class="tok-number">0x57</span>, <span class="tok-number">0x07</span>, <span class="tok-number">0xc7</span>, <span class="tok-number">0x47</span>, <span class="tok-number">0x1a</span>, <span class="tok-number">0x45</span>, <span class="tok-number">0x71</span>, <span class="tok-number">0x76</span>, <span class="tok-number">0x94</span>, <span class="tok-number">0xfb</span>, <span class="tok-number">0x05</span>, <span class="tok-number">0xad</span>, <span class="tok-number">0xec</span>, <span class="tok-number">0x12</span>, <span class="tok-number">0x29</span>, <span class="tok-number">0x5a</span>, <span class="tok-number">0x44</span>, <span class="tok-number">0x6a</span>, <span class="tok-number">0x81</span>, <span class="tok-number">0xd9</span>, <span class="tok-number">0xc6</span>, <span class="tok-number">0xf0</span>, <span class="tok-number">0xb6</span>, <span class="tok-number">0x9b</span>, <span class="tok-number">0x97</span>, <span class="tok-number">0x83</span>, <span class="tok-number">0x69</span>, <span class="tok-number">0xfb</span>, <span class="tok-number">0xdc</span>, <span class="tok-number">0x0d</span>, <span class="tok-number">0x4a</span>, <span class="tok-number">0x67</span>, <span class="tok-number">0xbc</span>, <span class="tok-number">0x72</span>, <span class="tok-number">0xf5</span>, <span class="tok-number">0x43</span>, <span class="tok-number">0x5e</span>, <span class="tok-number">0x9b</span>, <span class="tok-number">0x13</span>, <span class="tok-number">0xf2</span>, <span class="tok-number">0xe4</span>, <span class="tok-number">0x6d</span>, <span class="tok-number">0x49</span>, <span class="tok-number">0xdb</span>, <span class="tok-number">0x76</span>, <span class="tok-number">0xcb</span>, <span class="tok-number">0x42</span>, <span class="tok-number">0x6a</span>, <span class="tok-number">0x3c</span>, <span class="tok-number">0x9f</span>, <span class="tok-number">0xa1</span>, <span class="tok-number">0xfe</span>, <span class="tok-number">0x5e</span>, <span class="tok-number">0xca</span>, <span class="tok-number">0x0a</span>, <span class="tok-number">0xfc</span>, <span class="tok-number">0xfa</span>, <span class="tok-number">0x39</span>, <span class="tok-number">0x27</span>, <span class="tok-number">0xd1</span>, <span class="tok-number">0x3c</span>, <span class="tok-number">0xcb</span>, <span class="tok-number">0x9a</span>, <span class="tok-number">0xde</span>, <span class="tok-number">0x4c</span>, <span class="tok-number">0x6b</span>, <span class="tok-number">0x09</span>, <span class="tok-number">0x8b</span>, <span class="tok-number">0x49</span>, <span class="tok-number">0xfd</span>, <span class="tok-number">0x1e</span>, <span class="tok-number">0x3d</span>, <span class="tok-number">0x5e</span>, <span class="tok-number">0x67</span>, <span class="tok-number">0x7c</span>, <span class="tok-number">0x57</span>, <span class="tok-number">0xad</span>, <span class="tok-number">0x90</span>, <span class="tok-number">0xcc</span>, <span class="tok-number">0x46</span>, <span class="tok-number">0x5f</span>, <span class="tok-number">0x5c</span>, <span class="tok-number">0xae</span>, <span class="tok-number">0x6a</span>, <span class="tok-number">0x9c</span>, <span class="tok-number">0xb2</span>, <span class="tok-number">0xcd</span>, <span class="tok-number">0x2c</span>, <span class="tok-number">0x89</span>, <span class="tok-number">0x78</span>, <span class="tok-number">0xcf</span>, <span class="tok-number">0xf1</span>, <span class="tok-number">0x49</span>, <span class="tok-number">0x96</span>, <span class="tok-number">0x55</span>, <span class="tok-number">0x1e</span>, <span class="tok-number">0x04</span>, <span class="tok-number">0xef</span>, <span class="tok-number">0x0e</span>, <span class="tok-number">0x1c</span>, <span class="tok-number">0xde</span>, <span class="tok-number">0x6c</span>, <span class="tok-number">0x96</span>, <span class="tok-number">0x51</span>, <span class="tok-number">0x00</span>, <span class="tok-number">0xee</span>, <span class="tok-number">0x9a</span>, <span class="tok-number">0x1f</span>, <span class="tok-number">0x8d</span>, <span class="tok-number">0x61</span>, <span class="tok-number">0xbc</span>, <span class="tok-number">0xeb</span>, <span class="tok-number">0xb1</span>, <span class="tok-number">0xa6</span>, <span class="tok-number">0xa5</span>, <span class="tok-number">0x21</span>, <span class="tok-number">0x8b</span>, <span class="tok-number">0xa7</span>, <span class="tok-number">0xf8</span>, <span class="tok-number">0x25</span>, <span class="tok-number">0x41</span>, <span class="tok-number">0x48</span>, <span class="tok-number">0x62</span>, <span class="tok-number">0x5b</span>, <span class="tok-number">0x01</span>, <span class="tok-number">0x6c</span>, <span class="tok-number">0x7c</span>, <span class="tok-number">0x2a</span>, <span class="tok-number">0xe8</span>, <span class="tok-number">0xff</span>, <span class="tok-number">0xf9</span>, <span class="tok-number">0xf9</span>, <span class="tok-number">0x1f</span>, <span class="tok-number">0xe2</span>, <span class="tok-number">0x79</span>, <span class="tok-number">0x2e</span>, <span class="tok-number">0xd1</span>, <span class="tok-number">0xff</span>, <span class="tok-number">0xa3</span>, <span class="tok-number">0x2e</span>, <span class="tok-number">0x1c</span>, <span class="tok-number">0x3a</span>, <span class="tok-number">0x1a</span>, <span class="tok-number">0x5d</span>, <span class="tok-number">0x2b</span>, <span class="tok-number">0x7b</span>, <span class="tok-number">0x87</span>, <span class="tok-number">0x25</span>, <span class="tok-number">0x22</span>, <span class="tok-number">0xa4</span>, <span class="tok-number">0x90</span>, <span class="tok-number">0xea</span>, <span class="tok-number">0x26</span>, <span class="tok-number">0x9d</span>, <span class="tok-number">0xdd</span>, <span class="tok-number">0x13</span>, <span class="tok-number">0x60</span>, <span class="tok-number">0x4c</span>, <span class="tok-number">0x10</span>, <span class="tok-number">0x03</span>, <span class="tok-number">0xf6</span>, <span class="tok-number">0x99</span>, <span class="tok-number">0xd3</span>, <span class="tok-number">0x21</span>, <span class="tok-number">0x0c</span>, <span class="tok-number">0x69</span>, <span class="tok-number">0xc6</span>, <span class="tok-number">0xd8</span>, <span class="tok-number">0xc8</span>, <span class="tok-number">0x9e</span>, <span class="tok-number">0x94</span>, <span class="tok-number">0x89</span>, <span class="tok-number">0x51</span>, <span class="tok-number">0x21</span>, <span class="tok-number">0xe3</span>, <span class="tok-number">0x9a</span>, <span class="tok-number">0xcd</span>, <span class="tok-number">0xda</span>, <span class="tok-number">0x54</span>, <span class="tok-number">0x72</span>, <span class="tok-number">0x64</span>, <span class="tok-number">0xae</span>, <span class="tok-number">0x94</span>, <span class="tok-number">0x79</span>, <span class="tok-number">0x36</span>, <span class="tok-number">0x81</span>, <span class="tok-number">0x44</span>, <span class="tok-number">0x14</span>, <span class="tok-number">0x6d</span>, <span class="tok-number">0x3a</span>, <span class="tok-number">0x0e</span>, <span class="tok-number">0xa6</span>, <span class="tok-number">0x30</span>, <span class="tok-number">0xbf</span>, <span class="tok-number">0x95</span>, <span class="tok-number">0x99</span>, <span class="tok-number">0xa6</span>, <span class="tok-number">0xf5</span>, <span class="tok-number">0x7f</span>, <span class="tok-number">0x4f</span>, <span class="tok-number">0xef</span>, <span class="tok-number">0xc6</span>, <span class="tok-number">0x71</span>, <span class="tok-number">0x2f</span>, <span class="tok-number">0x36</span>, <span class="tok-number">0x13</span>, <span class="tok-number">0x14</span>, <span class="tok-number">0xa2</span>, <span class="tok-number">0x9d</span>, <span class="tok-number">0xc2</span>, <span class="tok-number">0x0c</span>, <span class="tok-number">0x0d</span>, <span class="tok-number">0x4e</span>, <span class="tok-number">0xc0</span>, <span class="tok-number">0x02</span>, <span class="tok-number">0xd3</span>, <span class="tok-number">0x6f</span>, <span class="tok-number">0xee</span>, <span class="tok-number">0x98</span>, <span class="tok-number">0x5e</span>, <span class="tok-number">0x24</span>, <span class="tok-number">0x31</span>, <span class="tok-number">0x74</span>, <span class="tok-number">0x11</span>, <span class="tok-number">0x96</span>, <span class="tok-number">0x6e</span>, <span class="tok-number">0x43</span>, <span class="tok-number">0x57</span>, <span class="tok-number">0xe8</span>, <span class="tok-number">0x8e</span>, <span class="tok-number">0xa0</span>, <span class="tok-number">0x8d</span>, <span class="tok-number">0x3d</span>, <span class="tok-number">0x79</span>, <span class="tok-number">0x38</span>, <span class="tok-number">0x20</span>, <span class="tok-number">0xc2</span>, <span class="tok-number">0x0f</span>, <span class="tok-number">0xb4</span>, <span class="tok-number">0x75</span>, <span class="tok-number">0x99</span>, <span class="tok-number">0x3b</span>, <span class="tok-number">0xb1</span>, <span class="tok-number">0xf0</span>, <span class="tok-number">0xe8</span>, <span class="tok-number">0xe1</span>, <span class="tok-number">0xda</span>, <span class="tok-number">0xf9</span>, <span class="tok-number">0xd4</span>, <span class="tok-number">0xe6</span>, <span class="tok-number">0xd6</span>, <span class="tok-number">0xf4</span>, <span class="tok-number">0x8a</span>, <span class="tok-number">0x32</span>, <span class="tok-number">0x4a</span>, <span class="tok-number">0x4a</span>, <span class="tok-number">0x25</span>, <span class="tok-number">0xa8</span>, <span class="tok-number">0xd9</span>, <span class="tok-number">0x60</span>, <span class="tok-number">0xd6</span>, <span class="tok-number">0x33</span>, <span class="tok-number">0x31</span>, <span class="tok-number">0x97</span>, <span class="tok-number">0xb9</span>, <span class="tok-number">0xb6</span>, <span class="tok-number">0xed</span>, <span class="tok-number">0x5f</span>, <span class="tok-number">0xfc</span>, <span class="tok-number">0x15</span>, <span class="tok-number">0xbd</span>, <span class="tok-number">0x13</span>, <span class="tok-number">0xc0</span>, <span class="tok-number">0x3a</span>, <span class="tok-number">0x3f</span>, <span class="tok-number">0x1f</span>, <span class="tok-number">0x2d</span>, <span class="tok-number">0x09</span>, <span class="tok-number">0x1d</span>, <span class="tok-number">0xeb</span>, <span class="tok-number">0x69</span>, <span class="tok-number">0x6a</span>, <span class="tok-number">0xfe</span>, <span class="tok-number">0xd7</span>, <span class="tok-number">0x95</span>, <span class="tok-number">0x3e</span>, <span class="tok-number">0x8a</span>, <span class="tok-number">0x4e</span>, <span class="tok-number">0xe1</span>, <span class="tok-number">0x6e</span>, <span class="tok-number">0x61</span>, <span class="tok-number">0xb2</span>, <span class="tok-number">0x6c</span>, <span class="tok-number">0xe3</span>, <span class="tok-number">0x2b</span>, <span class="tok-number">0x70</span>, <span class="tok-number">0x60</span>, <span class="tok-number">0x7e</span>, <span class="tok-number">0x8c</span>, <span class="tok-number">0xe4</span>, <span class="tok-number">0xdd</span>, <span class="tok-number">0x27</span>, <span class="tok-number">0x30</span>, <span class="tok-number">0x7e</span>, <span class="tok-number">0x0d</span>, <span class="tok-number">0xc7</span>, <span class="tok-number">0xb7</span>, <span class="tok-number">0x9a</span>, <span class="tok-number">0x1a</span>, <span class="tok-number">0x3c</span>, <span class="tok-number">0xcc</span>, <span class="tok-number">0xa7</span>, <span class="tok-number">0x22</span>, <span class="tok-number">0x77</span>, <span class="tok-number">0x14</span>, <span class="tok-number">0x05</span>, <span class="tok-number">0x50</span>, <span class="tok-number">0x57</span>, <span class="tok-number">0x31</span>, <span class="tok-number">0x1b</span>, <span class="tok-number">0xc8</span>, <span class="tok-number">0xbf</span>, <span class="tok-number">0xce</span>, <span class="tok-number">0x52</span>, <span class="tok-number">0xaf</span>, <span class="tok-number">0x9c</span>, <span class="tok-number">0x8e</span>, <span class="tok-number">0x10</span>, <span class="tok-number">0x2e</span>, <span class="tok-number">0xd2</span>, <span class="tok-number">0x16</span>, <span class="tok-number">0xb6</span>, <span class="tok-number">0x6e</span>, <span class="tok-number">0x43</span>, <span class="tok-number">0x10</span>, <span class="tok-number">0xaf</span>, <span class="tok-number">0x8b</span>, <span class="tok-number">0xde</span>, <span class="tok-number">0x1d</span>, <span class="tok-number">0x60</span>, <span class="tok-number">0xb2</span>, <span class="tok-number">0x7d</span>, <span class="tok-number">0xe6</span>, <span class="tok-number">0x2f</span>, <span class="tok-number">0x08</span>, <span class="tok-number">0x10</span>, <span class="tok-number">0x12</span>, <span class="tok-number">0x7e</span>, <span class="tok-number">0xb4</span>, <span class="tok-number">0x76</span>, <span class="tok-number">0x45</span>, <span class="tok-number">0xb6</span>, <span class="tok-number">0xd8</span>, <span class="tok-number">0x9b</span>, <span class="tok-number">0x26</span>, <span class="tok-number">0x40</span>, <span class="tok-number">0xa1</span>, <span class="tok-number">0x63</span>, <span class="tok-number">0x5c</span>, <span class="tok-number">0x7a</span>, <span class="tok-number">0x2a</span>, <span class="tok-number">0xb1</span>, <span class="tok-number">0x8c</span>, <span class="tok-number">0xd6</span>, <span class="tok-number">0xa4</span>, <span class="tok-number">0x6f</span>, <span class="tok-number">0x5a</span>, <span class="tok-number">0xae</span>, <span class="tok-number">0x33</span>, <span class="tok-number">0x7e</span>, <span class="tok-number">0x6d</span>, <span class="tok-number">0x71</span>, <span class="tok-number">0xf5</span>, <span class="tok-number">0xc8</span>, <span class="tok-number">0x6d</span>, <span class="tok-number">0x80</span>, <span class="tok-number">0x1c</span>, <span class="tok-number">0x35</span>, <span class="tok-number">0xfc</span>, <span class="tok-number">0x3f</span>, <span class="tok-number">0xc1</span>, <span class="tok-number">0xa6</span>, <span class="tok-number">0xc6</span>, <span class="tok-number">0x1a</span>, <span class="tok-number">0x15</span>, <span class="tok-number">0x04</span>, <span class="tok-number">0x6d</span>, <span class="tok-number">0x76</span>, <span class="tok-number">0x38</span>, <span class="tok-number">0x32</span>, <span class="tok-number">0x95</span>, <span class="tok-number">0xb2</span>, <span class="tok-number">0x51</span>, <span class="tok-number">0x1a</span>, <span class="tok-number">0xe9</span>, <span class="tok-number">0x3e</span>, <span class="tok-number">0x89</span>, <span class="tok-number">0x9f</span>, <span class="tok-number">0x0c</span>, <span class="tok-number">0x79</span> };</span>
<span class="line" id="L389">    <span class="tok-kw">var</span> out: [Sha3_256.digest_length]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L390"></span>
<span class="line" id="L391">    Sha3_256.hash(&amp;msg, &amp;out, .{});</span>
<span class="line" id="L392">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;5780048dfa381a1d01c747906e4a08711dd34fd712ecd7c6801dd2b38fd81a89&quot;</span>, &amp;out);</span>
<span class="line" id="L393"></span>
<span class="line" id="L394">    <span class="tok-kw">var</span> h = Sha3_256.init(.{});</span>
<span class="line" id="L395">    h.update(msg[<span class="tok-number">0</span>..<span class="tok-number">64</span>]);</span>
<span class="line" id="L396">    h.update(msg[<span class="tok-number">64</span>..<span class="tok-number">613</span>]);</span>
<span class="line" id="L397">    h.final(&amp;out);</span>
<span class="line" id="L398">    <span class="tok-kw">try</span> htest.assertEqual(<span class="tok-str">&quot;5780048dfa381a1d01c747906e4a08711dd34fd712ecd7c6801dd2b38fd81a89&quot;</span>, &amp;out);</span>
<span class="line" id="L399">}</span>
<span class="line" id="L400"></span>
</code></pre></body>
</html>