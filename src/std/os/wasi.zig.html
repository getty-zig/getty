<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>os/wasi.zig - source view</title>
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAPNJREFUeNpi/P//PwMlgOXHUjly9E0G4hwgZmQiQZMqEK8H4v9QzUEgQSaoADK+zhH9iAGL+C0gDoAaNg9mGLoLfgA1awK9hS9gzgJxA9RQBmQDrgMxJzRMGKE4HYj/Ial5A8QmQLwCJoBsgBYW2+TR1ChDaWt4LOBxKsi/VUh8XiD+gq4IVyzwQAMJBoKwacZlAB8Qf0bi96IZhtOAe1D6LpqaEiz6rmEzQAeIzwGxCJpieFqApo/vQKyJboAaEBsAsSEupwI1MwKjGBTVHOhegMX5UajYRqiBjMgYmj400cVh0XgTiKdC0zhJgJHS7AwQYABm9EAdCKrEfAAAAABJRU5ErkJggg=="/>
    <style>
      body{
        font-family: system-ui, -apple-system, Roboto, "Segoe UI", sans-serif;
        margin: 0;
        line-height: 1.5;
      }

      pre > code {
        display: block;
        overflow: auto;
        line-height: normal;
        margin: 0em;
      }
      .tok-kw {
          color: #333;
          font-weight: bold;
      }
      .tok-str {
          color: #d14;
      }
      .tok-builtin {
          color: #005C7A;
      }
      .tok-comment {
          color: #545454;
          font-style: italic;
      }
      .tok-fn {
          color: #900;
          font-weight: bold;
      }
      .tok-null {
          color: #005C5C;
      }
      .tok-number {
          color: #005C5C;
      }
      .tok-type {
          color: #458;
          font-weight: bold;
      }
      pre {
        counter-reset: line;
      }
      pre .line:before {
        counter-increment: line;
        content: counter(line);
        display: inline-block;
        padding-right: 1em;
        width: 2em;
        text-align: right;
        color: #999;
      }
      
      .line {
        width: 100%;
        display: inline-block;
      }
      .line:target {
        border-top: 1px solid #ccc;
        border-bottom: 1px solid #ccc;
        background: #fafafa;
      }

      @media (prefers-color-scheme: dark) {
        body{
            background:#222;
            color: #ccc;
        }
        pre > code {
            color: #ccc;
            background: #222;
            border: unset;
        }
        .line:target {
            border-top: 1px solid #444;
            border-bottom: 1px solid #444;
            background: #333;
        }
        .tok-kw {
            color: #eee;
        }
        .tok-str {
            color: #2e5;
        }
        .tok-builtin {
            color: #ff894c;
        }
        .tok-comment {
            color: #aa7;
        }
        .tok-fn {
            color: #B1A0F8;
        }
        .tok-null {
            color: #ff8080;
        }
        .tok-number {
            color: #ff8080;
        }
        .tok-type {
            color: #68f;
        }
      }
    </style>
</head>
<body>
<pre><code><span class="line" id="L1"><span class="tok-comment">// wasi_snapshot_preview1 spec available (in witx format) here:</span>
</span>
<span class="line" id="L2"><span class="tok-comment">// * typenames -- https://github.com/WebAssembly/WASI/blob/master/phases/snapshot/witx/typenames.witx</span>
</span>
<span class="line" id="L3"><span class="tok-comment">// * module -- https://github.com/WebAssembly/WASI/blob/master/phases/snapshot/witx/wasi_snapshot_preview1.witx</span>
</span>
<span class="line" id="L4"><span class="tok-kw">const</span> builtin = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;builtin&quot;</span>);</span>
<span class="line" id="L5"><span class="tok-kw">const</span> std = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;std&quot;</span>);</span>
<span class="line" id="L6"><span class="tok-kw">const</span> assert = std.debug.assert;</span>
<span class="line" id="L7"></span>
<span class="line" id="L8"><span class="tok-kw">comptime</span> {</span>
<span class="line" id="L9">    assert(<span class="tok-builtin">@alignOf</span>(<span class="tok-type">i8</span>) == <span class="tok-number">1</span>);</span>
<span class="line" id="L10">    assert(<span class="tok-builtin">@alignOf</span>(<span class="tok-type">u8</span>) == <span class="tok-number">1</span>);</span>
<span class="line" id="L11">    assert(<span class="tok-builtin">@alignOf</span>(<span class="tok-type">i16</span>) == <span class="tok-number">2</span>);</span>
<span class="line" id="L12">    assert(<span class="tok-builtin">@alignOf</span>(<span class="tok-type">u16</span>) == <span class="tok-number">2</span>);</span>
<span class="line" id="L13">    assert(<span class="tok-builtin">@alignOf</span>(<span class="tok-type">i32</span>) == <span class="tok-number">4</span>);</span>
<span class="line" id="L14">    assert(<span class="tok-builtin">@alignOf</span>(<span class="tok-type">u32</span>) == <span class="tok-number">4</span>);</span>
<span class="line" id="L15">    <span class="tok-comment">// assert(@alignOf(i64) == 8);</span>
</span>
<span class="line" id="L16">    <span class="tok-comment">// assert(@alignOf(u64) == 8);</span>
</span>
<span class="line" id="L17">}</span>
<span class="line" id="L18"></span>
<span class="line" id="L19"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> F_OK = <span class="tok-number">0</span>;</span>
<span class="line" id="L20"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> X_OK = <span class="tok-number">1</span>;</span>
<span class="line" id="L21"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> W_OK = <span class="tok-number">2</span>;</span>
<span class="line" id="L22"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> R_OK = <span class="tok-number">4</span>;</span>
<span class="line" id="L23"></span>
<span class="line" id="L24"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> iovec_t = std.os.iovec;</span>
<span class="line" id="L25"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ciovec_t = std.os.iovec_const;</span>
<span class="line" id="L26"></span>
<span class="line" id="L27"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">args_get</span>(argv: [*][*:<span class="tok-number">0</span>]<span class="tok-type">u8</span>, argv_buf: [*]<span class="tok-type">u8</span>) errno_t;</span>
<span class="line" id="L28"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">args_sizes_get</span>(argc: *<span class="tok-type">usize</span>, argv_buf_size: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L29"></span>
<span class="line" id="L30"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">clock_res_get</span>(clock_id: clockid_t, resolution: *timestamp_t) errno_t;</span>
<span class="line" id="L31"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">clock_time_get</span>(clock_id: clockid_t, precision: timestamp_t, timestamp: *timestamp_t) errno_t;</span>
<span class="line" id="L32"></span>
<span class="line" id="L33"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">environ_get</span>(environ: [*][*:<span class="tok-number">0</span>]<span class="tok-type">u8</span>, environ_buf: [*]<span class="tok-type">u8</span>) errno_t;</span>
<span class="line" id="L34"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">environ_sizes_get</span>(environ_count: *<span class="tok-type">usize</span>, environ_buf_size: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L35"></span>
<span class="line" id="L36"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_advise</span>(fd: fd_t, offset: filesize_t, len: filesize_t, advice: advice_t) errno_t;</span>
<span class="line" id="L37"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_allocate</span>(fd: fd_t, offset: filesize_t, len: filesize_t) errno_t;</span>
<span class="line" id="L38"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_close</span>(fd: fd_t) errno_t;</span>
<span class="line" id="L39"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_datasync</span>(fd: fd_t) errno_t;</span>
<span class="line" id="L40"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_pread</span>(fd: fd_t, iovs: [*]<span class="tok-kw">const</span> iovec_t, iovs_len: <span class="tok-type">usize</span>, offset: filesize_t, nread: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L41"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_pwrite</span>(fd: fd_t, iovs: [*]<span class="tok-kw">const</span> ciovec_t, iovs_len: <span class="tok-type">usize</span>, offset: filesize_t, nwritten: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L42"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_read</span>(fd: fd_t, iovs: [*]<span class="tok-kw">const</span> iovec_t, iovs_len: <span class="tok-type">usize</span>, nread: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L43"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_readdir</span>(fd: fd_t, buf: [*]<span class="tok-type">u8</span>, buf_len: <span class="tok-type">usize</span>, cookie: dircookie_t, bufused: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L44"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_renumber</span>(from: fd_t, to: fd_t) errno_t;</span>
<span class="line" id="L45"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_seek</span>(fd: fd_t, offset: filedelta_t, whence: whence_t, newoffset: *filesize_t) errno_t;</span>
<span class="line" id="L46"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_sync</span>(fd: fd_t) errno_t;</span>
<span class="line" id="L47"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_tell</span>(fd: fd_t, newoffset: *filesize_t) errno_t;</span>
<span class="line" id="L48"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_write</span>(fd: fd_t, iovs: [*]<span class="tok-kw">const</span> ciovec_t, iovs_len: <span class="tok-type">usize</span>, nwritten: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L49"></span>
<span class="line" id="L50"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_fdstat_get</span>(fd: fd_t, buf: *fdstat_t) errno_t;</span>
<span class="line" id="L51"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_fdstat_set_flags</span>(fd: fd_t, flags: fdflags_t) errno_t;</span>
<span class="line" id="L52"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_fdstat_set_rights</span>(fd: fd_t, fs_rights_base: rights_t, fs_rights_inheriting: rights_t) errno_t;</span>
<span class="line" id="L53"></span>
<span class="line" id="L54"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_filestat_get</span>(fd: fd_t, buf: *filestat_t) errno_t;</span>
<span class="line" id="L55"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_filestat_set_size</span>(fd: fd_t, st_size: filesize_t) errno_t;</span>
<span class="line" id="L56"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_filestat_set_times</span>(fd: fd_t, st_atim: timestamp_t, st_mtim: timestamp_t, fstflags: fstflags_t) errno_t;</span>
<span class="line" id="L57"></span>
<span class="line" id="L58"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_prestat_get</span>(fd: fd_t, buf: *prestat_t) errno_t;</span>
<span class="line" id="L59"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">fd_prestat_dir_name</span>(fd: fd_t, path: [*]<span class="tok-type">u8</span>, path_len: <span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L60"></span>
<span class="line" id="L61"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_create_directory</span>(fd: fd_t, path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, path_len: <span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L62"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_filestat_get</span>(fd: fd_t, flags: lookupflags_t, path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, path_len: <span class="tok-type">usize</span>, buf: *filestat_t) errno_t;</span>
<span class="line" id="L63"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_filestat_set_times</span>(fd: fd_t, flags: lookupflags_t, path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, path_len: <span class="tok-type">usize</span>, st_atim: timestamp_t, st_mtim: timestamp_t, fstflags: fstflags_t) errno_t;</span>
<span class="line" id="L64"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_link</span>(old_fd: fd_t, old_flags: lookupflags_t, old_path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, old_path_len: <span class="tok-type">usize</span>, new_fd: fd_t, new_path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, new_path_len: <span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L65"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_open</span>(dirfd: fd_t, dirflags: lookupflags_t, path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, path_len: <span class="tok-type">usize</span>, oflags: oflags_t, fs_rights_base: rights_t, fs_rights_inheriting: rights_t, fs_flags: fdflags_t, fd: *fd_t) errno_t;</span>
<span class="line" id="L66"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_readlink</span>(fd: fd_t, path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, path_len: <span class="tok-type">usize</span>, buf: [*]<span class="tok-type">u8</span>, buf_len: <span class="tok-type">usize</span>, bufused: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L67"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_remove_directory</span>(fd: fd_t, path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, path_len: <span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L68"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_rename</span>(old_fd: fd_t, old_path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, old_path_len: <span class="tok-type">usize</span>, new_fd: fd_t, new_path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, new_path_len: <span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L69"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_symlink</span>(old_path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, old_path_len: <span class="tok-type">usize</span>, fd: fd_t, new_path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, new_path_len: <span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L70"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">path_unlink_file</span>(fd: fd_t, path: [*]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, path_len: <span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L71"></span>
<span class="line" id="L72"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">poll_oneoff</span>(in: *<span class="tok-kw">const</span> subscription_t, out: *event_t, nsubscriptions: <span class="tok-type">usize</span>, nevents: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L73"></span>
<span class="line" id="L74"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">proc_exit</span>(rval: exitcode_t) <span class="tok-type">noreturn</span>;</span>
<span class="line" id="L75"></span>
<span class="line" id="L76"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">random_get</span>(buf: [*]<span class="tok-type">u8</span>, buf_len: <span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L77"></span>
<span class="line" id="L78"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">sched_yield</span>() errno_t;</span>
<span class="line" id="L79"></span>
<span class="line" id="L80"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">sock_accept</span>(sock: fd_t, flags: fdflags_t, result_fd: *fd_t) errno_t;</span>
<span class="line" id="L81"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">sock_recv</span>(sock: fd_t, ri_data: *<span class="tok-kw">const</span> iovec_t, ri_data_len: <span class="tok-type">usize</span>, ri_flags: riflags_t, ro_datalen: *<span class="tok-type">usize</span>, ro_flags: *roflags_t) errno_t;</span>
<span class="line" id="L82"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">sock_send</span>(sock: fd_t, si_data: *<span class="tok-kw">const</span> ciovec_t, si_data_len: <span class="tok-type">usize</span>, si_flags: siflags_t, so_datalen: *<span class="tok-type">usize</span>) errno_t;</span>
<span class="line" id="L83"><span class="tok-kw">pub</span> <span class="tok-kw">extern</span> <span class="tok-str">&quot;wasi_snapshot_preview1&quot;</span> <span class="tok-kw">fn</span> <span class="tok-fn">sock_shutdown</span>(sock: fd_t, how: sdflags_t) errno_t;</span>
<span class="line" id="L84"></span>
<span class="line" id="L85"><span class="tok-comment">/// Get the errno from a syscall return value, or 0 for no error.</span></span>
<span class="line" id="L86"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getErrno</span>(r: errno_t) errno_t {</span>
<span class="line" id="L87">    <span class="tok-kw">return</span> r;</span>
<span class="line" id="L88">}</span>
<span class="line" id="L89"></span>
<span class="line" id="L90"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> STDIN_FILENO = <span class="tok-number">0</span>;</span>
<span class="line" id="L91"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> STDOUT_FILENO = <span class="tok-number">1</span>;</span>
<span class="line" id="L92"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> STDERR_FILENO = <span class="tok-number">2</span>;</span>
<span class="line" id="L93"></span>
<span class="line" id="L94"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> mode_t = <span class="tok-type">u32</span>;</span>
<span class="line" id="L95"></span>
<span class="line" id="L96"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> time_t = <span class="tok-type">i64</span>; <span class="tok-comment">// match https://github.com/CraneStation/wasi-libc</span>
</span>
<span class="line" id="L97"></span>
<span class="line" id="L98"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> timespec = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L99">    tv_sec: time_t,</span>
<span class="line" id="L100">    tv_nsec: <span class="tok-type">isize</span>,</span>
<span class="line" id="L101"></span>
<span class="line" id="L102">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">fromTimestamp</span>(tm: timestamp_t) timespec {</span>
<span class="line" id="L103">        <span class="tok-kw">const</span> tv_sec: timestamp_t = tm / <span class="tok-number">1_000_000_000</span>;</span>
<span class="line" id="L104">        <span class="tok-kw">const</span> tv_nsec = tm - tv_sec * <span class="tok-number">1_000_000_000</span>;</span>
<span class="line" id="L105">        <span class="tok-kw">return</span> timespec{</span>
<span class="line" id="L106">            .tv_sec = <span class="tok-builtin">@as</span>(time_t, <span class="tok-builtin">@intCast</span>(tv_sec)),</span>
<span class="line" id="L107">            .tv_nsec = <span class="tok-builtin">@as</span>(<span class="tok-type">isize</span>, <span class="tok-builtin">@intCast</span>(tv_nsec)),</span>
<span class="line" id="L108">        };</span>
<span class="line" id="L109">    }</span>
<span class="line" id="L110"></span>
<span class="line" id="L111">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">toTimestamp</span>(ts: timespec) timestamp_t {</span>
<span class="line" id="L112">        <span class="tok-kw">const</span> tm = <span class="tok-builtin">@as</span>(timestamp_t, <span class="tok-builtin">@intCast</span>(ts.tv_sec * <span class="tok-number">1_000_000_000</span>)) + <span class="tok-builtin">@as</span>(timestamp_t, <span class="tok-builtin">@intCast</span>(ts.tv_nsec));</span>
<span class="line" id="L113">        <span class="tok-kw">return</span> tm;</span>
<span class="line" id="L114">    }</span>
<span class="line" id="L115">};</span>
<span class="line" id="L116"></span>
<span class="line" id="L117"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Stat = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L118">    dev: device_t,</span>
<span class="line" id="L119">    ino: inode_t,</span>
<span class="line" id="L120">    mode: mode_t,</span>
<span class="line" id="L121">    filetype: filetype_t,</span>
<span class="line" id="L122">    nlink: linkcount_t,</span>
<span class="line" id="L123">    size: filesize_t,</span>
<span class="line" id="L124">    atim: timespec,</span>
<span class="line" id="L125">    mtim: timespec,</span>
<span class="line" id="L126">    ctim: timespec,</span>
<span class="line" id="L127"></span>
<span class="line" id="L128">    <span class="tok-kw">const</span> Self = <span class="tok-builtin">@This</span>();</span>
<span class="line" id="L129"></span>
<span class="line" id="L130">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">fromFilestat</span>(stat: filestat_t) Self {</span>
<span class="line" id="L131">        <span class="tok-kw">return</span> Self{</span>
<span class="line" id="L132">            .dev = stat.dev,</span>
<span class="line" id="L133">            .ino = stat.ino,</span>
<span class="line" id="L134">            .mode = <span class="tok-number">0</span>,</span>
<span class="line" id="L135">            .filetype = stat.filetype,</span>
<span class="line" id="L136">            .nlink = stat.nlink,</span>
<span class="line" id="L137">            .size = stat.size,</span>
<span class="line" id="L138">            .atim = stat.atime(),</span>
<span class="line" id="L139">            .mtim = stat.mtime(),</span>
<span class="line" id="L140">            .ctim = stat.ctime(),</span>
<span class="line" id="L141">        };</span>
<span class="line" id="L142">    }</span>
<span class="line" id="L143"></span>
<span class="line" id="L144">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">atime</span>(self: Self) timespec {</span>
<span class="line" id="L145">        <span class="tok-kw">return</span> self.atim;</span>
<span class="line" id="L146">    }</span>
<span class="line" id="L147"></span>
<span class="line" id="L148">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">mtime</span>(self: Self) timespec {</span>
<span class="line" id="L149">        <span class="tok-kw">return</span> self.mtim;</span>
<span class="line" id="L150">    }</span>
<span class="line" id="L151"></span>
<span class="line" id="L152">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">ctime</span>(self: Self) timespec {</span>
<span class="line" id="L153">        <span class="tok-kw">return</span> self.ctim;</span>
<span class="line" id="L154">    }</span>
<span class="line" id="L155">};</span>
<span class="line" id="L156"></span>
<span class="line" id="L157"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> IOV_MAX = <span class="tok-number">1024</span>;</span>
<span class="line" id="L158"></span>
<span class="line" id="L159"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> AT = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L160">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> REMOVEDIR: <span class="tok-type">u32</span> = <span class="tok-number">0x4</span>;</span>
<span class="line" id="L161">    <span class="tok-comment">/// When linking libc, we follow their convention and use -2 for current working directory.</span></span>
<span class="line" id="L162">    <span class="tok-comment">/// However, without libc, Zig does a different convention: it assumes the</span></span>
<span class="line" id="L163">    <span class="tok-comment">/// current working directory is the first preopen. This behavior can be</span></span>
<span class="line" id="L164">    <span class="tok-comment">/// overridden with a public function called `wasi_cwd` in the root source</span></span>
<span class="line" id="L165">    <span class="tok-comment">/// file.</span></span>
<span class="line" id="L166">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FDCWD: fd_t = <span class="tok-kw">if</span> (builtin.link_libc) -<span class="tok-number">2</span> <span class="tok-kw">else</span> <span class="tok-number">3</span>;</span>
<span class="line" id="L167">};</span>
<span class="line" id="L168"></span>
<span class="line" id="L169"><span class="tok-comment">// As defined in the wasi_snapshot_preview1 spec file:</span>
</span>
<span class="line" id="L170"><span class="tok-comment">// https://github.com/WebAssembly/WASI/blob/master/phases/snapshot/witx/typenames.witx</span>
</span>
<span class="line" id="L171"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> advice_t = <span class="tok-type">u8</span>;</span>
<span class="line" id="L172"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ADVICE_NORMAL: advice_t = <span class="tok-number">0</span>;</span>
<span class="line" id="L173"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ADVICE_SEQUENTIAL: advice_t = <span class="tok-number">1</span>;</span>
<span class="line" id="L174"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ADVICE_RANDOM: advice_t = <span class="tok-number">2</span>;</span>
<span class="line" id="L175"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ADVICE_WILLNEED: advice_t = <span class="tok-number">3</span>;</span>
<span class="line" id="L176"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ADVICE_DONTNEED: advice_t = <span class="tok-number">4</span>;</span>
<span class="line" id="L177"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ADVICE_NOREUSE: advice_t = <span class="tok-number">5</span>;</span>
<span class="line" id="L178"></span>
<span class="line" id="L179"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> clockid_t = <span class="tok-type">u32</span>;</span>
<span class="line" id="L180"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> CLOCK = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L181">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> REALTIME: clockid_t = <span class="tok-number">0</span>;</span>
<span class="line" id="L182">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> MONOTONIC: clockid_t = <span class="tok-number">1</span>;</span>
<span class="line" id="L183">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PROCESS_CPUTIME_ID: clockid_t = <span class="tok-number">2</span>;</span>
<span class="line" id="L184">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> THREAD_CPUTIME_ID: clockid_t = <span class="tok-number">3</span>;</span>
<span class="line" id="L185">};</span>
<span class="line" id="L186"></span>
<span class="line" id="L187"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> device_t = <span class="tok-type">u64</span>;</span>
<span class="line" id="L188"></span>
<span class="line" id="L189"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> dircookie_t = <span class="tok-type">u64</span>;</span>
<span class="line" id="L190"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> DIRCOOKIE_START: dircookie_t = <span class="tok-number">0</span>;</span>
<span class="line" id="L191"></span>
<span class="line" id="L192"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> dirnamlen_t = <span class="tok-type">u32</span>;</span>
<span class="line" id="L193"></span>
<span class="line" id="L194"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> dirent_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L195">    d_next: dircookie_t,</span>
<span class="line" id="L196">    d_ino: inode_t,</span>
<span class="line" id="L197">    d_namlen: dirnamlen_t,</span>
<span class="line" id="L198">    d_type: filetype_t,</span>
<span class="line" id="L199">};</span>
<span class="line" id="L200"></span>
<span class="line" id="L201"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> errno_t = <span class="tok-kw">enum</span>(<span class="tok-type">u16</span>) {</span>
<span class="line" id="L202">    SUCCESS = <span class="tok-number">0</span>,</span>
<span class="line" id="L203">    @&quot;2BIG&quot; = <span class="tok-number">1</span>,</span>
<span class="line" id="L204">    ACCES = <span class="tok-number">2</span>,</span>
<span class="line" id="L205">    ADDRINUSE = <span class="tok-number">3</span>,</span>
<span class="line" id="L206">    ADDRNOTAVAIL = <span class="tok-number">4</span>,</span>
<span class="line" id="L207">    AFNOSUPPORT = <span class="tok-number">5</span>,</span>
<span class="line" id="L208">    <span class="tok-comment">/// This is also the error code used for `WOULDBLOCK`.</span></span>
<span class="line" id="L209">    AGAIN = <span class="tok-number">6</span>,</span>
<span class="line" id="L210">    ALREADY = <span class="tok-number">7</span>,</span>
<span class="line" id="L211">    BADF = <span class="tok-number">8</span>,</span>
<span class="line" id="L212">    BADMSG = <span class="tok-number">9</span>,</span>
<span class="line" id="L213">    BUSY = <span class="tok-number">10</span>,</span>
<span class="line" id="L214">    CANCELED = <span class="tok-number">11</span>,</span>
<span class="line" id="L215">    CHILD = <span class="tok-number">12</span>,</span>
<span class="line" id="L216">    CONNABORTED = <span class="tok-number">13</span>,</span>
<span class="line" id="L217">    CONNREFUSED = <span class="tok-number">14</span>,</span>
<span class="line" id="L218">    CONNRESET = <span class="tok-number">15</span>,</span>
<span class="line" id="L219">    DEADLK = <span class="tok-number">16</span>,</span>
<span class="line" id="L220">    DESTADDRREQ = <span class="tok-number">17</span>,</span>
<span class="line" id="L221">    DOM = <span class="tok-number">18</span>,</span>
<span class="line" id="L222">    DQUOT = <span class="tok-number">19</span>,</span>
<span class="line" id="L223">    EXIST = <span class="tok-number">20</span>,</span>
<span class="line" id="L224">    FAULT = <span class="tok-number">21</span>,</span>
<span class="line" id="L225">    FBIG = <span class="tok-number">22</span>,</span>
<span class="line" id="L226">    HOSTUNREACH = <span class="tok-number">23</span>,</span>
<span class="line" id="L227">    IDRM = <span class="tok-number">24</span>,</span>
<span class="line" id="L228">    ILSEQ = <span class="tok-number">25</span>,</span>
<span class="line" id="L229">    INPROGRESS = <span class="tok-number">26</span>,</span>
<span class="line" id="L230">    INTR = <span class="tok-number">27</span>,</span>
<span class="line" id="L231">    INVAL = <span class="tok-number">28</span>,</span>
<span class="line" id="L232">    IO = <span class="tok-number">29</span>,</span>
<span class="line" id="L233">    ISCONN = <span class="tok-number">30</span>,</span>
<span class="line" id="L234">    ISDIR = <span class="tok-number">31</span>,</span>
<span class="line" id="L235">    LOOP = <span class="tok-number">32</span>,</span>
<span class="line" id="L236">    MFILE = <span class="tok-number">33</span>,</span>
<span class="line" id="L237">    MLINK = <span class="tok-number">34</span>,</span>
<span class="line" id="L238">    MSGSIZE = <span class="tok-number">35</span>,</span>
<span class="line" id="L239">    MULTIHOP = <span class="tok-number">36</span>,</span>
<span class="line" id="L240">    NAMETOOLONG = <span class="tok-number">37</span>,</span>
<span class="line" id="L241">    NETDOWN = <span class="tok-number">38</span>,</span>
<span class="line" id="L242">    NETRESET = <span class="tok-number">39</span>,</span>
<span class="line" id="L243">    NETUNREACH = <span class="tok-number">40</span>,</span>
<span class="line" id="L244">    NFILE = <span class="tok-number">41</span>,</span>
<span class="line" id="L245">    NOBUFS = <span class="tok-number">42</span>,</span>
<span class="line" id="L246">    NODEV = <span class="tok-number">43</span>,</span>
<span class="line" id="L247">    NOENT = <span class="tok-number">44</span>,</span>
<span class="line" id="L248">    NOEXEC = <span class="tok-number">45</span>,</span>
<span class="line" id="L249">    NOLCK = <span class="tok-number">46</span>,</span>
<span class="line" id="L250">    NOLINK = <span class="tok-number">47</span>,</span>
<span class="line" id="L251">    NOMEM = <span class="tok-number">48</span>,</span>
<span class="line" id="L252">    NOMSG = <span class="tok-number">49</span>,</span>
<span class="line" id="L253">    NOPROTOOPT = <span class="tok-number">50</span>,</span>
<span class="line" id="L254">    NOSPC = <span class="tok-number">51</span>,</span>
<span class="line" id="L255">    NOSYS = <span class="tok-number">52</span>,</span>
<span class="line" id="L256">    NOTCONN = <span class="tok-number">53</span>,</span>
<span class="line" id="L257">    NOTDIR = <span class="tok-number">54</span>,</span>
<span class="line" id="L258">    NOTEMPTY = <span class="tok-number">55</span>,</span>
<span class="line" id="L259">    NOTRECOVERABLE = <span class="tok-number">56</span>,</span>
<span class="line" id="L260">    NOTSOCK = <span class="tok-number">57</span>,</span>
<span class="line" id="L261">    <span class="tok-comment">/// This is also the code used for `NOTSUP`.</span></span>
<span class="line" id="L262">    OPNOTSUPP = <span class="tok-number">58</span>,</span>
<span class="line" id="L263">    NOTTY = <span class="tok-number">59</span>,</span>
<span class="line" id="L264">    NXIO = <span class="tok-number">60</span>,</span>
<span class="line" id="L265">    OVERFLOW = <span class="tok-number">61</span>,</span>
<span class="line" id="L266">    OWNERDEAD = <span class="tok-number">62</span>,</span>
<span class="line" id="L267">    PERM = <span class="tok-number">63</span>,</span>
<span class="line" id="L268">    PIPE = <span class="tok-number">64</span>,</span>
<span class="line" id="L269">    PROTO = <span class="tok-number">65</span>,</span>
<span class="line" id="L270">    PROTONOSUPPORT = <span class="tok-number">66</span>,</span>
<span class="line" id="L271">    PROTOTYPE = <span class="tok-number">67</span>,</span>
<span class="line" id="L272">    RANGE = <span class="tok-number">68</span>,</span>
<span class="line" id="L273">    ROFS = <span class="tok-number">69</span>,</span>
<span class="line" id="L274">    SPIPE = <span class="tok-number">70</span>,</span>
<span class="line" id="L275">    SRCH = <span class="tok-number">71</span>,</span>
<span class="line" id="L276">    STALE = <span class="tok-number">72</span>,</span>
<span class="line" id="L277">    TIMEDOUT = <span class="tok-number">73</span>,</span>
<span class="line" id="L278">    TXTBSY = <span class="tok-number">74</span>,</span>
<span class="line" id="L279">    XDEV = <span class="tok-number">75</span>,</span>
<span class="line" id="L280">    NOTCAPABLE = <span class="tok-number">76</span>,</span>
<span class="line" id="L281">    _,</span>
<span class="line" id="L282">};</span>
<span class="line" id="L283"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> E = errno_t;</span>
<span class="line" id="L284"></span>
<span class="line" id="L285"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> event_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L286">    userdata: userdata_t,</span>
<span class="line" id="L287">    @&quot;error&quot;: errno_t,</span>
<span class="line" id="L288">    <span class="tok-type">type</span>: eventtype_t,</span>
<span class="line" id="L289">    fd_readwrite: eventfdreadwrite_t,</span>
<span class="line" id="L290">};</span>
<span class="line" id="L291"></span>
<span class="line" id="L292"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> eventfdreadwrite_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L293">    nbytes: filesize_t,</span>
<span class="line" id="L294">    flags: eventrwflags_t,</span>
<span class="line" id="L295">};</span>
<span class="line" id="L296"></span>
<span class="line" id="L297"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> eventrwflags_t = <span class="tok-type">u16</span>;</span>
<span class="line" id="L298"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> EVENT_FD_READWRITE_HANGUP: eventrwflags_t = <span class="tok-number">0x0001</span>;</span>
<span class="line" id="L299"></span>
<span class="line" id="L300"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> eventtype_t = <span class="tok-type">u8</span>;</span>
<span class="line" id="L301"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> EVENTTYPE_CLOCK: eventtype_t = <span class="tok-number">0</span>;</span>
<span class="line" id="L302"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> EVENTTYPE_FD_READ: eventtype_t = <span class="tok-number">1</span>;</span>
<span class="line" id="L303"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> EVENTTYPE_FD_WRITE: eventtype_t = <span class="tok-number">2</span>;</span>
<span class="line" id="L304"></span>
<span class="line" id="L305"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> exitcode_t = <span class="tok-type">u32</span>;</span>
<span class="line" id="L306"></span>
<span class="line" id="L307"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> fd_t = <span class="tok-type">i32</span>;</span>
<span class="line" id="L308"></span>
<span class="line" id="L309"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> fdflags_t = <span class="tok-type">u16</span>;</span>
<span class="line" id="L310"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> FDFLAG = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L311">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> APPEND: fdflags_t = <span class="tok-number">0x0001</span>;</span>
<span class="line" id="L312">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> DSYNC: fdflags_t = <span class="tok-number">0x0002</span>;</span>
<span class="line" id="L313">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> NONBLOCK: fdflags_t = <span class="tok-number">0x0004</span>;</span>
<span class="line" id="L314">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> RSYNC: fdflags_t = <span class="tok-number">0x0008</span>;</span>
<span class="line" id="L315">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> SYNC: fdflags_t = <span class="tok-number">0x0010</span>;</span>
<span class="line" id="L316">};</span>
<span class="line" id="L317"></span>
<span class="line" id="L318"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> fdstat_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L319">    fs_filetype: filetype_t,</span>
<span class="line" id="L320">    fs_flags: fdflags_t,</span>
<span class="line" id="L321">    fs_rights_base: rights_t,</span>
<span class="line" id="L322">    fs_rights_inheriting: rights_t,</span>
<span class="line" id="L323">};</span>
<span class="line" id="L324"></span>
<span class="line" id="L325"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> filedelta_t = <span class="tok-type">i64</span>;</span>
<span class="line" id="L326"></span>
<span class="line" id="L327"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> filesize_t = <span class="tok-type">u64</span>;</span>
<span class="line" id="L328"></span>
<span class="line" id="L329"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> filestat_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L330">    dev: device_t,</span>
<span class="line" id="L331">    ino: inode_t,</span>
<span class="line" id="L332">    filetype: filetype_t,</span>
<span class="line" id="L333">    nlink: linkcount_t,</span>
<span class="line" id="L334">    size: filesize_t,</span>
<span class="line" id="L335">    atim: timestamp_t,</span>
<span class="line" id="L336">    mtim: timestamp_t,</span>
<span class="line" id="L337">    ctim: timestamp_t,</span>
<span class="line" id="L338"></span>
<span class="line" id="L339">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">atime</span>(self: filestat_t) timespec {</span>
<span class="line" id="L340">        <span class="tok-kw">return</span> timespec.fromTimestamp(self.atim);</span>
<span class="line" id="L341">    }</span>
<span class="line" id="L342"></span>
<span class="line" id="L343">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">mtime</span>(self: filestat_t) timespec {</span>
<span class="line" id="L344">        <span class="tok-kw">return</span> timespec.fromTimestamp(self.mtim);</span>
<span class="line" id="L345">    }</span>
<span class="line" id="L346"></span>
<span class="line" id="L347">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">ctime</span>(self: filestat_t) timespec {</span>
<span class="line" id="L348">        <span class="tok-kw">return</span> timespec.fromTimestamp(self.ctim);</span>
<span class="line" id="L349">    }</span>
<span class="line" id="L350">};</span>
<span class="line" id="L351"></span>
<span class="line" id="L352"><span class="tok-comment">/// Also known as `FILETYPE`.</span></span>
<span class="line" id="L353"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> filetype_t = <span class="tok-kw">enum</span>(<span class="tok-type">u8</span>) {</span>
<span class="line" id="L354">    UNKNOWN,</span>
<span class="line" id="L355">    BLOCK_DEVICE,</span>
<span class="line" id="L356">    CHARACTER_DEVICE,</span>
<span class="line" id="L357">    DIRECTORY,</span>
<span class="line" id="L358">    REGULAR_FILE,</span>
<span class="line" id="L359">    SOCKET_DGRAM,</span>
<span class="line" id="L360">    SOCKET_STREAM,</span>
<span class="line" id="L361">    SYMBOLIC_LINK,</span>
<span class="line" id="L362">    _,</span>
<span class="line" id="L363">};</span>
<span class="line" id="L364"></span>
<span class="line" id="L365"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> fstflags_t = <span class="tok-type">u16</span>;</span>
<span class="line" id="L366"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> FILESTAT_SET_ATIM: fstflags_t = <span class="tok-number">0x0001</span>;</span>
<span class="line" id="L367"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> FILESTAT_SET_ATIM_NOW: fstflags_t = <span class="tok-number">0x0002</span>;</span>
<span class="line" id="L368"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> FILESTAT_SET_MTIM: fstflags_t = <span class="tok-number">0x0004</span>;</span>
<span class="line" id="L369"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> FILESTAT_SET_MTIM_NOW: fstflags_t = <span class="tok-number">0x0008</span>;</span>
<span class="line" id="L370"></span>
<span class="line" id="L371"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> inode_t = <span class="tok-type">u64</span>;</span>
<span class="line" id="L372"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> ino_t = inode_t;</span>
<span class="line" id="L373"></span>
<span class="line" id="L374"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> linkcount_t = <span class="tok-type">u64</span>;</span>
<span class="line" id="L375"></span>
<span class="line" id="L376"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> lookupflags_t = <span class="tok-type">u32</span>;</span>
<span class="line" id="L377"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> LOOKUP_SYMLINK_FOLLOW: lookupflags_t = <span class="tok-number">0x00000001</span>;</span>
<span class="line" id="L378"></span>
<span class="line" id="L379"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> oflags_t = <span class="tok-type">u16</span>;</span>
<span class="line" id="L380"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> O = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L381">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> CREAT: oflags_t = <span class="tok-number">0x0001</span>;</span>
<span class="line" id="L382">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> DIRECTORY: oflags_t = <span class="tok-number">0x0002</span>;</span>
<span class="line" id="L383">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> EXCL: oflags_t = <span class="tok-number">0x0004</span>;</span>
<span class="line" id="L384">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> TRUNC: oflags_t = <span class="tok-number">0x0008</span>;</span>
<span class="line" id="L385">};</span>
<span class="line" id="L386"></span>
<span class="line" id="L387"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> preopentype_t = <span class="tok-type">u8</span>;</span>
<span class="line" id="L388"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> PREOPENTYPE_DIR: preopentype_t = <span class="tok-number">0</span>;</span>
<span class="line" id="L389"></span>
<span class="line" id="L390"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> prestat_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L391">    pr_type: preopentype_t,</span>
<span class="line" id="L392">    u: prestat_u_t,</span>
<span class="line" id="L393">};</span>
<span class="line" id="L394"></span>
<span class="line" id="L395"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> prestat_dir_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L396">    pr_name_len: <span class="tok-type">usize</span>,</span>
<span class="line" id="L397">};</span>
<span class="line" id="L398"></span>
<span class="line" id="L399"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> prestat_u_t = <span class="tok-kw">extern</span> <span class="tok-kw">union</span> {</span>
<span class="line" id="L400">    dir: prestat_dir_t,</span>
<span class="line" id="L401">};</span>
<span class="line" id="L402"></span>
<span class="line" id="L403"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> riflags_t = <span class="tok-type">u16</span>;</span>
<span class="line" id="L404"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> roflags_t = <span class="tok-type">u16</span>;</span>
<span class="line" id="L405"></span>
<span class="line" id="L406"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SOCK = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L407">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> RECV_PEEK: riflags_t = <span class="tok-number">0x0001</span>;</span>
<span class="line" id="L408">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> RECV_WAITALL: riflags_t = <span class="tok-number">0x0002</span>;</span>
<span class="line" id="L409"></span>
<span class="line" id="L410">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> RECV_DATA_TRUNCATED: roflags_t = <span class="tok-number">0x0001</span>;</span>
<span class="line" id="L411">};</span>
<span class="line" id="L412"></span>
<span class="line" id="L413"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> rights_t = <span class="tok-type">u64</span>;</span>
<span class="line" id="L414"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> RIGHT = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L415">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_DATASYNC: rights_t = <span class="tok-number">0x0000000000000001</span>;</span>
<span class="line" id="L416">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_READ: rights_t = <span class="tok-number">0x0000000000000002</span>;</span>
<span class="line" id="L417">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_SEEK: rights_t = <span class="tok-number">0x0000000000000004</span>;</span>
<span class="line" id="L418">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_FDSTAT_SET_FLAGS: rights_t = <span class="tok-number">0x0000000000000008</span>;</span>
<span class="line" id="L419">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_SYNC: rights_t = <span class="tok-number">0x0000000000000010</span>;</span>
<span class="line" id="L420">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_TELL: rights_t = <span class="tok-number">0x0000000000000020</span>;</span>
<span class="line" id="L421">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_WRITE: rights_t = <span class="tok-number">0x0000000000000040</span>;</span>
<span class="line" id="L422">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_ADVISE: rights_t = <span class="tok-number">0x0000000000000080</span>;</span>
<span class="line" id="L423">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_ALLOCATE: rights_t = <span class="tok-number">0x0000000000000100</span>;</span>
<span class="line" id="L424">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_CREATE_DIRECTORY: rights_t = <span class="tok-number">0x0000000000000200</span>;</span>
<span class="line" id="L425">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_CREATE_FILE: rights_t = <span class="tok-number">0x0000000000000400</span>;</span>
<span class="line" id="L426">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_LINK_SOURCE: rights_t = <span class="tok-number">0x0000000000000800</span>;</span>
<span class="line" id="L427">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_LINK_TARGET: rights_t = <span class="tok-number">0x0000000000001000</span>;</span>
<span class="line" id="L428">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_OPEN: rights_t = <span class="tok-number">0x0000000000002000</span>;</span>
<span class="line" id="L429">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_READDIR: rights_t = <span class="tok-number">0x0000000000004000</span>;</span>
<span class="line" id="L430">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_READLINK: rights_t = <span class="tok-number">0x0000000000008000</span>;</span>
<span class="line" id="L431">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_RENAME_SOURCE: rights_t = <span class="tok-number">0x0000000000010000</span>;</span>
<span class="line" id="L432">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_RENAME_TARGET: rights_t = <span class="tok-number">0x0000000000020000</span>;</span>
<span class="line" id="L433">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_FILESTAT_GET: rights_t = <span class="tok-number">0x0000000000040000</span>;</span>
<span class="line" id="L434">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_FILESTAT_SET_SIZE: rights_t = <span class="tok-number">0x0000000000080000</span>;</span>
<span class="line" id="L435">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_FILESTAT_SET_TIMES: rights_t = <span class="tok-number">0x0000000000100000</span>;</span>
<span class="line" id="L436">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_FILESTAT_GET: rights_t = <span class="tok-number">0x0000000000200000</span>;</span>
<span class="line" id="L437">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_FILESTAT_SET_SIZE: rights_t = <span class="tok-number">0x0000000000400000</span>;</span>
<span class="line" id="L438">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FD_FILESTAT_SET_TIMES: rights_t = <span class="tok-number">0x0000000000800000</span>;</span>
<span class="line" id="L439">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_SYMLINK: rights_t = <span class="tok-number">0x0000000001000000</span>;</span>
<span class="line" id="L440">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_REMOVE_DIRECTORY: rights_t = <span class="tok-number">0x0000000002000000</span>;</span>
<span class="line" id="L441">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> PATH_UNLINK_FILE: rights_t = <span class="tok-number">0x0000000004000000</span>;</span>
<span class="line" id="L442">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> POLL_FD_READWRITE: rights_t = <span class="tok-number">0x0000000008000000</span>;</span>
<span class="line" id="L443">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> SOCK_SHUTDOWN: rights_t = <span class="tok-number">0x0000000010000000</span>;</span>
<span class="line" id="L444">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> SOCK_ACCEPT: rights_t = <span class="tok-number">0x0000000020000000</span>;</span>
<span class="line" id="L445">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> ALL: rights_t = FD_DATASYNC |</span>
<span class="line" id="L446">        FD_READ |</span>
<span class="line" id="L447">        FD_SEEK |</span>
<span class="line" id="L448">        FD_FDSTAT_SET_FLAGS |</span>
<span class="line" id="L449">        FD_SYNC |</span>
<span class="line" id="L450">        FD_TELL |</span>
<span class="line" id="L451">        FD_WRITE |</span>
<span class="line" id="L452">        FD_ADVISE |</span>
<span class="line" id="L453">        FD_ALLOCATE |</span>
<span class="line" id="L454">        PATH_CREATE_DIRECTORY |</span>
<span class="line" id="L455">        PATH_CREATE_FILE |</span>
<span class="line" id="L456">        PATH_LINK_SOURCE |</span>
<span class="line" id="L457">        PATH_LINK_TARGET |</span>
<span class="line" id="L458">        PATH_OPEN |</span>
<span class="line" id="L459">        FD_READDIR |</span>
<span class="line" id="L460">        PATH_READLINK |</span>
<span class="line" id="L461">        PATH_RENAME_SOURCE |</span>
<span class="line" id="L462">        PATH_RENAME_TARGET |</span>
<span class="line" id="L463">        PATH_FILESTAT_GET |</span>
<span class="line" id="L464">        PATH_FILESTAT_SET_SIZE |</span>
<span class="line" id="L465">        PATH_FILESTAT_SET_TIMES |</span>
<span class="line" id="L466">        FD_FILESTAT_GET |</span>
<span class="line" id="L467">        FD_FILESTAT_SET_SIZE |</span>
<span class="line" id="L468">        FD_FILESTAT_SET_TIMES |</span>
<span class="line" id="L469">        PATH_SYMLINK |</span>
<span class="line" id="L470">        PATH_REMOVE_DIRECTORY |</span>
<span class="line" id="L471">        PATH_UNLINK_FILE |</span>
<span class="line" id="L472">        POLL_FD_READWRITE |</span>
<span class="line" id="L473">        SOCK_SHUTDOWN |</span>
<span class="line" id="L474">        SOCK_ACCEPT;</span>
<span class="line" id="L475">};</span>
<span class="line" id="L476"></span>
<span class="line" id="L477"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> sdflags_t = <span class="tok-type">u8</span>;</span>
<span class="line" id="L478"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SHUT = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L479">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> RD: sdflags_t = <span class="tok-number">0x01</span>;</span>
<span class="line" id="L480">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> WR: sdflags_t = <span class="tok-number">0x02</span>;</span>
<span class="line" id="L481">};</span>
<span class="line" id="L482"></span>
<span class="line" id="L483"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> siflags_t = <span class="tok-type">u16</span>;</span>
<span class="line" id="L484"></span>
<span class="line" id="L485"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> signal_t = <span class="tok-type">u8</span>;</span>
<span class="line" id="L486"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGNONE: signal_t = <span class="tok-number">0</span>;</span>
<span class="line" id="L487"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGHUP: signal_t = <span class="tok-number">1</span>;</span>
<span class="line" id="L488"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGINT: signal_t = <span class="tok-number">2</span>;</span>
<span class="line" id="L489"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGQUIT: signal_t = <span class="tok-number">3</span>;</span>
<span class="line" id="L490"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGILL: signal_t = <span class="tok-number">4</span>;</span>
<span class="line" id="L491"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGTRAP: signal_t = <span class="tok-number">5</span>;</span>
<span class="line" id="L492"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGABRT: signal_t = <span class="tok-number">6</span>;</span>
<span class="line" id="L493"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGBUS: signal_t = <span class="tok-number">7</span>;</span>
<span class="line" id="L494"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGFPE: signal_t = <span class="tok-number">8</span>;</span>
<span class="line" id="L495"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGKILL: signal_t = <span class="tok-number">9</span>;</span>
<span class="line" id="L496"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGUSR1: signal_t = <span class="tok-number">10</span>;</span>
<span class="line" id="L497"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGSEGV: signal_t = <span class="tok-number">11</span>;</span>
<span class="line" id="L498"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGUSR2: signal_t = <span class="tok-number">12</span>;</span>
<span class="line" id="L499"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGPIPE: signal_t = <span class="tok-number">13</span>;</span>
<span class="line" id="L500"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGALRM: signal_t = <span class="tok-number">14</span>;</span>
<span class="line" id="L501"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGTERM: signal_t = <span class="tok-number">15</span>;</span>
<span class="line" id="L502"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGCHLD: signal_t = <span class="tok-number">16</span>;</span>
<span class="line" id="L503"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGCONT: signal_t = <span class="tok-number">17</span>;</span>
<span class="line" id="L504"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGSTOP: signal_t = <span class="tok-number">18</span>;</span>
<span class="line" id="L505"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGTSTP: signal_t = <span class="tok-number">19</span>;</span>
<span class="line" id="L506"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGTTIN: signal_t = <span class="tok-number">20</span>;</span>
<span class="line" id="L507"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGTTOU: signal_t = <span class="tok-number">21</span>;</span>
<span class="line" id="L508"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGURG: signal_t = <span class="tok-number">22</span>;</span>
<span class="line" id="L509"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGXCPU: signal_t = <span class="tok-number">23</span>;</span>
<span class="line" id="L510"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGXFSZ: signal_t = <span class="tok-number">24</span>;</span>
<span class="line" id="L511"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGVTALRM: signal_t = <span class="tok-number">25</span>;</span>
<span class="line" id="L512"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGPROF: signal_t = <span class="tok-number">26</span>;</span>
<span class="line" id="L513"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGWINCH: signal_t = <span class="tok-number">27</span>;</span>
<span class="line" id="L514"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGPOLL: signal_t = <span class="tok-number">28</span>;</span>
<span class="line" id="L515"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGPWR: signal_t = <span class="tok-number">29</span>;</span>
<span class="line" id="L516"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SIGSYS: signal_t = <span class="tok-number">30</span>;</span>
<span class="line" id="L517"></span>
<span class="line" id="L518"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> subclockflags_t = <span class="tok-type">u16</span>;</span>
<span class="line" id="L519"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> SUBSCRIPTION_CLOCK_ABSTIME: subclockflags_t = <span class="tok-number">0x0001</span>;</span>
<span class="line" id="L520"></span>
<span class="line" id="L521"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> subscription_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L522">    userdata: userdata_t,</span>
<span class="line" id="L523">    u: subscription_u_t,</span>
<span class="line" id="L524">};</span>
<span class="line" id="L525"></span>
<span class="line" id="L526"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> subscription_clock_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L527">    id: clockid_t,</span>
<span class="line" id="L528">    timeout: timestamp_t,</span>
<span class="line" id="L529">    precision: timestamp_t,</span>
<span class="line" id="L530">    flags: subclockflags_t,</span>
<span class="line" id="L531">};</span>
<span class="line" id="L532"></span>
<span class="line" id="L533"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> subscription_fd_readwrite_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L534">    fd: fd_t,</span>
<span class="line" id="L535">};</span>
<span class="line" id="L536"></span>
<span class="line" id="L537"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> subscription_u_t = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L538">    tag: eventtype_t,</span>
<span class="line" id="L539">    u: subscription_u_u_t,</span>
<span class="line" id="L540">};</span>
<span class="line" id="L541"></span>
<span class="line" id="L542"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> subscription_u_u_t = <span class="tok-kw">extern</span> <span class="tok-kw">union</span> {</span>
<span class="line" id="L543">    clock: subscription_clock_t,</span>
<span class="line" id="L544">    fd_read: subscription_fd_readwrite_t,</span>
<span class="line" id="L545">    fd_write: subscription_fd_readwrite_t,</span>
<span class="line" id="L546">};</span>
<span class="line" id="L547"></span>
<span class="line" id="L548"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> timestamp_t = <span class="tok-type">u64</span>;</span>
<span class="line" id="L549"></span>
<span class="line" id="L550"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> userdata_t = <span class="tok-type">u64</span>;</span>
<span class="line" id="L551"></span>
<span class="line" id="L552"><span class="tok-comment">/// Also known as `WHENCE`.</span></span>
<span class="line" id="L553"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> whence_t = <span class="tok-kw">enum</span>(<span class="tok-type">u8</span>) { SET, CUR, END };</span>
<span class="line" id="L554"></span>
<span class="line" id="L555"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> S = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L556">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IEXEC = <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;TODO audit this&quot;</span>);</span>
<span class="line" id="L557">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IFBLK = <span class="tok-number">0x6000</span>;</span>
<span class="line" id="L558">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IFCHR = <span class="tok-number">0x2000</span>;</span>
<span class="line" id="L559">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IFDIR = <span class="tok-number">0x4000</span>;</span>
<span class="line" id="L560">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IFIFO = <span class="tok-number">0xc000</span>;</span>
<span class="line" id="L561">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IFLNK = <span class="tok-number">0xa000</span>;</span>
<span class="line" id="L562">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IFMT = IFBLK | IFCHR | IFDIR | IFIFO | IFLNK | IFREG | IFSOCK;</span>
<span class="line" id="L563">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IFREG = <span class="tok-number">0x8000</span>;</span>
<span class="line" id="L564">    <span class="tok-comment">// There's no concept of UNIX domain socket but we define this value here in order to line with other OSes.</span>
</span>
<span class="line" id="L565">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> IFSOCK = <span class="tok-number">0x1</span>;</span>
<span class="line" id="L566">};</span>
<span class="line" id="L567"></span>
<span class="line" id="L568"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> LOCK = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L569">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> SH = <span class="tok-number">0x1</span>;</span>
<span class="line" id="L570">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> EX = <span class="tok-number">0x2</span>;</span>
<span class="line" id="L571">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> NB = <span class="tok-number">0x4</span>;</span>
<span class="line" id="L572">    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> UN = <span class="tok-number">0x8</span>;</span>
<span class="line" id="L573">};</span>
<span class="line" id="L574"></span>
</code></pre></body>
</html>